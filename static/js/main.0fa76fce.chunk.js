(this.webpackJsonpgemini=this.webpackJsonpgemini||[]).push([[0],{287:function(e,t,n){e.exports=n(424)},292:function(e,t,n){},387:function(e,t,n){},424:function(e,t,n){"use strict";n.r(t);var a=n(28),i=n.n(a),r=n(184),o=n.n(r),l=(n(292),n(133)),c=n(147),s=n(94),d=n(256),u=n.n(d),g=(n(155),n(264));var h=function(e){var t=e.code,n=e.readOnly,r=Object(a.useRef)(null),o=Object(a.useState)(t),l=Object(c.a)(o,2),s=l[0],d=l[1];return Object(a.useEffect)((function(){d(t)}),[t]),i.a.createElement(i.a.Fragment,null,i.a.createElement(g.a,{handleWidth:!0,handleHeight:!0,onResize:function(e,t){var n;null===r||void 0===r||null===(n=r.current)||void 0===n||n.layout({width:e,height:t})}}),i.a.createElement(u.a,{language:"json",value:s,theme:"test",options:{autoClosingBrackets:"never",autoClosingQuotes:"never",cursorBlinking:"smooth",folding:!0,lineNumbersMinChars:4,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",lineNumbers:"off",renderLineHighlight:"line",renderIndentGuides:!0,readOnly:n},onChange:function(t,n){d(t),e.onChange&&e.onChange(t)},editorDidMount:function(e,t){console.log("editorDidMount",e),r.current=e,e.focus()},editorWillMount:function(e){}}))},f=n(179),v=n.n(f),y=n(211),m=n(259),p=[{name:"Gene Annotation Plot (Simple)",spec:{tracks:[{data:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/Homo_sapiens.GRCh38.92.glyph.csv",mark:{server:"gemini.v1",type:"glyph-gene-annotation-v2"},x:{field:"start",type:"quantitative"},x1:{field:"end",type:"quantitative"},y:{field:"strand",type:"nominal"},text:{field:"gene_name",type:"nominal"},geneOrExon:{field:"feature",type:"nominal"},color:{value:"#D1D28D"},opacity:{value:.7},stroke:{value:"white"}}]},previewWidth:300,previewHeight:300},{name:"Gene Annotation Plot",spec:{tracks:[{data:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/Homo_sapiens.GRCh38.92.glyph.csv",mark:{server:"gemini.v1",type:"glyph-gene-annotation-v1"},x:{field:"start",type:"quantitative"},x1:{field:"end",type:"quantitative"},y:{field:"strand",type:"nominal"},text:{field:"gene_name",type:"nominal"},color:{field:"strand",type:"nominal"},exonVersion:{field:"exon_version",type:"nominal"},geneOrExon:{field:"feature",type:"nominal"},exonId:{field:"exon_id",type:"nominal"},opacity:{value:.9}}]},previewWidth:600,previewHeight:300},{name:"Cytogenetic Band",spec:{tracks:[{data:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/chr1_cytogenetic_band.glyph.csv",mark:{server:"gemini.v1",type:"cytogenetic-band-v1"},x:{field:"Basepair_start",type:"quantitative"},x1:{field:"Basepair_stop",type:"quantitative"},y:{field:"Chr.",type:"nominal"},text:{field:"Band",type:"nominal"},stain:{field:"Stain",type:"nominal"},color:{field:"Density",type:"nominal",domain:["","25","50","75","100"],range:["white","#D9D9D9","#979797","#636363","black"]}}]},previewWidth:900,previewHeight:300}];n(387);function x(e){return"object"===typeof e&&"glyph"===e.type}function k(e){return null!==e&&"object"===typeof e&&"value"in e}function E(e){return null!==e&&"object"===typeof e&&"bind"in e}function b(e){return"object"===typeof e&&"field"in e}var O=n(178),w=n(260),j=n(261);var z=function(){function e(t){Object(w.a)(this,e),this.track=void 0,this.channelToField=void 0,this.domains=void 0,this.scales=void 0,this.ranges=void 0,this.track=t,this.domains={},this.channelToField={},this.scales={},this.ranges={},x(this.track.mark)&&(this.track.mark.elements=function(e){var t=[];return e.forEach((function(e){if("object"===typeof e.mark)for(var n=e.mark.bind,a=0;a<e.mark.domain.length;a++){var i=e.mark.domain[a],r=e.mark.range[a],o=e.select?e.select:[];t.push(Object(l.a)(Object(l.a)({},e),{},{mark:r,select:[].concat(Object(O.a)(o),[{channel:n,oneOf:[i]}])}))}else t.push(e)})),t}(this.track.mark.elements)),this.setDomains()}return Object(j.a)(e,[{key:"getTrack",value:function(){return this.track}},{key:"getElements",value:function(){return x(this.track.mark)?this.track.mark.elements:[]}},{key:"getFieldByChannel",value:function(e){return this.channelToField[e]}},{key:"setDomains",value:function(){var e=this,t=this.track.data;x(this.track.mark)&&(this.track.mark.requiredChannels.forEach((function(n){var a=e.track[n];if(b(a)){var i=a.field;e.channelToField[n]=i;var r="x1"===n?"x":"y1"===n?"y":n;e.domains[r]||(e.domains[r]=[]),e.domains[r]=[].concat(Object(O.a)(e.domains[r]),Object(O.a)(a.domain?a.domain:t.map((function(e){return e[i]}))))}})),Object.keys(this.domains).forEach((function(t){var n=e.track[t];if(b(n)){var a=n.type;e.domains[t]="nominal"===a?s.i(e.domains[t]).values():s.b(e.domains[t].map((function(e){return+e})))}})))}},{key:"setRanges",value:function(e){var t=this;Object.keys(this.domains).forEach((function(n){var a=t.track[n];b(a)&&("x"===n?t.ranges.x=[e.x,e.x1]:"y"===n?t.ranges.y=[e.y,e.y1]:"color"===n&&(t.ranges.color=a.range?a.range:s.g))}))}},{key:"setScales",value:function(e){var t=this;this.setRanges(e),Object.keys(this.domains).forEach((function(e){var n=t.track[e];if(b(n)){var a=n.type;t.ranges[e]&&(t.scales[e]="color"===e&&"nominal"===a?s.e().domain(t.domains[e]).range(t.ranges[e]):"color"===e&&"quantitative"===a?s.f(s.c).domain(t.domains[e]):"nominal"===a?s.e().domain(t.domains[e]).range(t.ranges[e]):s.d().domain(t.domains[e]).range(t.ranges[e]))}}))}},{key:"getEncoding",value:function(e,t,n,a){var i="x1"===t?"x":"y1"===t?"y":t;if(k(e[t]))switch(t){case"size":case"opacity":case"color":case"text":return e[t].value}else if(k(this.track[t]))switch(t){case"size":case"opacity":case"color":case"text":return this.track[t].value}else{if(this.scales[i]){var r=E(e[t])?this.getFieldByChannel(e[t].bind):this.getFieldByChannel(t);return this.scales[i](n[r])}if("text"!==t){if("w"===t){if(this.scales.x&&b(this.track.x)&&b(this.track.x1)&&"none"!==e.x&&"none"!==e.x1){var o=Math.abs(n[this.getFieldByChannel("x1")]-n[this.getFieldByChannel("x")]);return this.scales.x(o)}return this.getEncoding(e,"size",n)}return{opacity:1,size:10,color:"black",text:""}[t]}var l=E(e.text)?this.getFieldByChannel(e.text.bind):b(this.track.text)?this.track.text.field:void 0;if(l)return n[l]}}},{key:"getScale",value:function(e){return this.scales[e]}}]),e}();function C(e,t,n,a){if(e&&t){s.h(e).selectAll("*").remove();var i=n,r=a;!function(e,t,n,a,i){s.h(e).attr("width",t).attr("height",n);var r=s.h(e).append("g");r.append("rect").attr("width",t).attr("height",n).attr("stroke","lightgray").attr("fill","white"),r.append("line").attr("x1",0).attr("x2",t).attr("y1",i).attr("y2",i).attr("class","preview-guideline"),r.append("line").attr("x1",0).attr("x2",t).attr("y1",n-i).attr("y2",n-i).attr("class","preview-guideline"),r.append("line").attr("x1",a).attr("x2",a).attr("y1",0).attr("y2",n).attr("class","preview-guideline"),r.append("line").attr("x1",t-a).attr("x2",t-a).attr("y1",0).attr("y2",n).attr("class","preview-guideline"),r.append("line").attr("x1",0).attr("x2",t).attr("y1",n/2).attr("y2",n/2).attr("class","preview-guideline"),r.append("line").attr("x1",t/2).attr("x2",t/2).attr("y1",0).attr("y2",n).attr("class","preview-guideline")}(e,i,r,60,100),function(e,t,n){var a=new z(t);a.setScales(Object(l.a)(Object(l.a)({},n),{},{y:(n.y1-n.y)/2}));var i=t.data;i?x(t.mark)?a.getElements().forEach((function(t){var n=t.select,r=t.mark,o=[];null===n||void 0===n||n.forEach((function(e){var t=e.channel,n=e.oneOf;a.getFieldByChannel(t)&&o.push({field:a.getFieldByChannel(t),oneOf:n})}));var l,c,s=function(e,t){var n=e.slice();return t.forEach((function(e){n=n.filter((function(t){return-1!==e.oneOf.indexOf(t[e.field])}))})),n}(i,o);if("line"===r)e.selectAll().data(s).enter().append("line").attr("x1",(function(e){return a.getEncoding(t,"x",e)})).attr("x2",(function(e){return a.getEncoding(t,"x1",e)})).attr("y1",(function(e){return a.getEncoding(t,"y",e)})).attr("y2",(function(e){return a.getEncoding(t,"y",e)})).attr("stroke",(function(e){return a.getEncoding(t,"color",e)})).attr("stroke-width",(function(e){return a.getEncoding(t,"size",e)})).attr("opacity",(function(e){return a.getEncoding(t,"opacity",e)})).style("stroke-dasharray",null!==(l=null===(c=t.styles)||void 0===c?void 0:c.dashed)&&void 0!==l?l:"");else if("point"===r)e.selectAll("point").data(s).enter().append("circle").attr("fill",(function(e){return a.getEncoding(t,"color",e)})).attr("cx",(function(e){return a.getEncoding(t,"x",e)})).attr("cy",(function(e){return a.getEncoding(t,"x",e)})).attr("r",15).attr("opacity",(function(e){return a.getEncoding(t,"opacity",e)}));else if("rect"===r){var d,u,g,h;e.selectAll().data(s).enter().append("rect").attr("x",(function(e){return a.getEncoding(t,"x",e)})).attr("y",(function(e){return a.getEncoding(t,"y",e)-a.getEncoding(t,"size",e)/2})).attr("width",(function(e){return a.getEncoding(t,"x1",e)-a.getEncoding(t,"x",e)})).attr("height",(function(e){return a.getEncoding(t,"size",e)})).attr("fill",(function(e){return a.getEncoding(t,"color",e)})).attr("opacity",(function(e){return a.getEncoding(t,"opacity",e)})).attr("stroke",null!==(d=null===(u=t.styles)||void 0===u?void 0:u.stroke)&&void 0!==d?d:"").attr("stroke-width",null!==(g=null===(h=t.styles)||void 0===h?void 0:h.strokeWidth)&&void 0!==g?g:"")}else if("text"===r)e.selectAll().data(s).enter().append("text").text((function(e){return a.getEncoding(t,"text",e)})).attr("x",(function(e){return(a.getEncoding(t,"x",e)+a.getEncoding(t,"x1",e))/2})).attr("y",(function(e){var n;return a.getEncoding(t,"y",e)+(null===(n=t.styles)||void 0===n?void 0:n.dy)})).attr("fill",(function(e){return a.getEncoding(t,"color",e)})).attr("font-size",(function(e){return a.getEncoding(t,"size",e)})).attr("alignment-baseline","top").attr("text-anchor","middle").attr("opacity",(function(e){return a.getEncoding(t,"opacity",e)}));else if("rule"===r)e.selectAll("rule").data(s).enter().append("line").attr("x1",(function(e){return a.getEncoding(t,"x",e)})).attr("x2",(function(e){return a.getEncoding(t,"x",e)})).attr("y1",(function(e){return a.getEncoding(t,"x",e)-a.getEncoding(t,"size",e)/2})).attr("y2",(function(e){return a.getEncoding(t,"x",e)-a.getEncoding(t,"size",e)/2})).attr("stroke",(function(e){return a.getEncoding(t,"color",e)})).attr("stroke-width",3).attr("opacity",(function(e){return a.getEncoding(t,"opacity",e)}));else if("triangle-r"===r){var f,v,y,m;e.selectAll("trangle-r").data(s).enter().append("path").attr("d",(function(e){var n=a.getEncoding(t,"size",e),i=a.getEncoding(t,"w",e),r=a.getEncoding(t,"x",e),o=a.getEncoding(t,"y",e);return"M".concat(r+i," ").concat(o)+"L".concat(r," ").concat(o+n/2)+"L".concat(r," ").concat(o-n/2," Z")})).attr("fill",(function(e){return a.getEncoding(t,"color",e)})).attr("opacity",(function(e){return a.getEncoding(t,"opacity",e)})).attr("stroke",null!==(f=null===(v=t.styles)||void 0===v?void 0:v.stroke)&&void 0!==f?f:"").attr("stroke-width",null!==(y=null===(m=t.styles)||void 0===m?void 0:m.strokeWidth)&&void 0!==y?y:"")}else if("triangle-l"===r){var p,x,k,E;e.selectAll("trangle-l").data(s).enter().append("path").attr("d",(function(e){var n=a.getEncoding(t,"size",e),i=a.getEncoding(t,"w",e),r=a.getEncoding(t,"x",e),o=a.getEncoding(t,"y",e);return"M".concat(r," ").concat(o)+"L".concat(r+i," ").concat(o+n/2)+"L".concat(r+i," ").concat(o-n/2," Z")})).attr("fill",(function(e){return a.getEncoding(t,"color",e)})).attr("opacity",(function(e){return a.getEncoding(t,"opacity",e)})).attr("stroke",null!==(p=null===(x=t.styles)||void 0===x?void 0:x.stroke)&&void 0!==p?p:"").attr("stroke-width",null!==(k=null===(E=t.styles)||void 0===E?void 0:E.strokeWidth)&&void 0!==k?k:"")}})):console.warn("Glyph is not defined."):console.warn("No array of a JSON object suggested.")}(s.h(e).append("g").attr("width",i-120).attr("height",r-200).attr("transform","translate(".concat(60,",").concat(100,")")),t,{x:0,x1:i-120,y:0,y1:r-200})}}n(262),n(263);var F=[{name:"glyph-gene-annotation-v1",mark:{type:"glyph",name:"gene-annotation",requiredChannels:["x","x1","y","color","geneOrExon","exonId","exonVersion"],elements:[{description:"horizontal line",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:"line",color:{value:"black"},size:{value:3}},{description:"exon",select:[{channel:"geneOrExon",oneOf:["exon"]},{channel:"exonVersion",oneOf:["2"]}],mark:"rect",size:{value:25}},{description:"gene left",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:{bind:"y",domain:["-","+"],range:["triangle-l","rule"]},size:{value:25},x1:"none"},{description:"gene right",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:{bind:"y",domain:["-","+"],range:["rule","triangle-r"]},size:{value:25},x:{bind:"x1"},x1:"none"},{mark:"text",select:[{channel:"geneOrExon",oneOf:["gene"]}],opacity:{value:1},size:{value:18},styles:{dy:-20}},{mark:"text",select:[{channel:"geneOrExon",oneOf:["exon"]},{channel:"exonVersion",oneOf:["2"]}],text:{bind:"exonId"},opacity:{value:1},size:{value:6},styles:{dy:28}}]}},{name:"glyph-gene-annotation-v2",mark:{type:"glyph",name:"gene-annotation",requiredChannels:["x","x1","y","color","geneOrExon"],elements:[{description:"gene",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:"rect",size:{value:25}},{description:"gene head",select:[{channel:"geneOrExon",oneOf:["gene"]},{channel:"y",oneOf:["-"]}],mark:"triangle-l",size:{value:25},x1:"none"},{description:"gene right",select:[{channel:"geneOrExon",oneOf:["gene"]},{channel:"y",oneOf:["+"]}],mark:"triangle-r",size:{value:25},x:{bind:"x1"},x1:"none"},{description:"horizontal line",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:"line",color:{value:"gray"},size:{value:2},styles:{dashed:"3, 3"}},{mark:"text",select:[{channel:"geneOrExon",oneOf:["gene"]}],color:{value:"black"},opacity:{value:1},size:{value:18},styles:{dy:-20}}]}},{name:"cytogenetic-band-v1",mark:{type:"glyph",name:"cytogenetic-band",requiredChannels:["x","x1","y","color","text","stain"],elements:[{description:"acen bg",select:[{channel:"text",oneOf:["11","11.1"]}],mark:{bind:"text",domain:["11","11.1"],range:["triangle-l","triangle-r"]},color:{value:"#6E7F8F"},size:{value:29},styles:{stroke:"black",strokeWidth:2}},{description:"symbols background",select:[{channel:"stain",oneOf:["gneg","gpos","gvar"]}],mark:"rect",size:{value:26},styles:{stroke:"black",strokeWidth:3}},{description:"symbols",select:[{channel:"stain",oneOf:["gneg","gpos","gvar"]}],mark:"rect",size:{value:25}},{description:"acen",select:[{channel:"text",oneOf:["11","11.1"]}],mark:{bind:"text",domain:["11","11.1"],range:["triangle-l","triangle-r"]},color:{value:"#B40101"},size:{value:30}},{mark:"text",select:[{channel:"color",oneOf:["100","75","50"]}],color:{value:"black"},size:{value:10},styles:{dy:-20}}]}},{name:"glyph-logo-plot-v1",mark:{type:"glyph",name:"logo",requiredChannels:["x","x1","y"],elements:[{mark:"bar"},{mark:"text",color:{value:"black"}}]}}],B=["glyph-gene-annotation-v1","glyph-gene-annotation-v2","cytogenetic-band-v1","glyph-logo-plot-v1"];function S(e){for(var t=function(t){var n,a,i=e.tracks[t],r=null===(n=i.mark)||void 0===n?void 0:n.type;B.includes(r)&&(i.mark=null===(a=F.find((function(e){return e.name===r})))||void 0===a?void 0:a.mark)},n=0;n<e.tracks.length;n++)t(n);return e}var D=function(){var e=Object(a.useRef)(null),t=Object(a.useRef)(null),n=Object(a.useState)(p[0]),r=Object(c.a)(n,2),o=r[0],d=r[1],u=Object(a.useState)("Full Glyph Definition"),g=Object(c.a)(u,2),f=g[0],x=g[1],k=Object(a.useState)(v()(p[0].spec)),E=Object(c.a)(k,2),b=E[0],O=E[1],w=Object(a.useState)(p[0].previewWidth),j=Object(c.a)(w,2),z=j[0],F=j[1],B=Object(a.useState)(p[0].previewHeight),D=Object(c.a)(B,2),W=D[0],G=D[1];return Object(a.useEffect)((function(){O("Full Glyph Definition"===f?v()(S(JSON.parse(v()(o.spec)))):v()(o.spec)),F(o.previewWidth),G(o.previewHeight)}),[o,f]),Object(a.useEffect)((function(){var t,n,a;try{a=S(JSON.parse(b))}catch(r){console.warn("Cannnot parse the edited code.")}if(a){var i=null===(t=a)||void 0===t||null===(n=t.tracks)||void 0===n?void 0:n.find((function(e){var t;return"glyph"===(null===(t=e.mark)||void 0===t?void 0:t.type)}));i&&s.a(i.data).then((function(t){return C(e.current,Object(l.a)(Object(l.a)({},i),{},{data:t}),z,W)}))}}),[b,z,W]),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"demo-navbar"},"\ud83e\uddecGemini ",i.a.createElement("code",null,"Editor"),i.a.createElement("select",{onChange:function(e){d(p.find((function(t){return t.name===e.target.value})))},defaultValue:o.name},p.map((function(e){return i.a.createElement("option",{key:e.name,value:e.name},e.name)}))),i.a.createElement("select",{onChange:function(e){x(e.target.value)},defaultValue:"Full Glyph Definition"},["Full Glyph Definition","Predefined Glyph"].map((function(e){return i.a.createElement("option",{key:e,value:e},e)})))),i.a.createElement("div",{className:"editor"},i.a.createElement(y.a,{split:"vertical",defaultSize:"50%",onChange:function(){}},i.a.createElement(h,{code:b,readOnly:!1,onChange:Object(m.debounce)((function(e){O(e)}),1e3)}),i.a.createElement(y.a,{split:"horizontal",defaultSize:"35%",onChange:function(){}},i.a.createElement("div",{className:"preview-container"},i.a.createElement("b",null,"Glyph Preview"),i.a.createElement("div",null,i.a.createElement("svg",{ref:e}))),i.a.createElement("div",{className:"preview-container"},i.a.createElement("b",null,"Layout Preview"),i.a.createElement("div",null,i.a.createElement("svg",{ref:t})))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[287,1,2]]]);
//# sourceMappingURL=main.0fa76fce.chunk.js.map