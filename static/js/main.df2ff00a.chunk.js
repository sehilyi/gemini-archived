(this.webpackJsonpgemini=this.webpackJsonpgemini||[]).push([[0],{255:function(t){t.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://higlass.io/#viewconf","title":"HiGlass viewconf","type":"object","additionalProperties":false,"required":[],"properties":{"editable":{"type":"boolean","default":true},"viewEditable":{"type":"boolean","default":true},"tracksEditable":{"type":"boolean","default":true},"zoomFixed":{"type":"boolean"},"exportViewUrl":{"type":"string"},"trackSourceServers":{"type":"array","items":{"type":"string"},"minLength":1},"zoomLocks":{"$ref":"#/definitions/locks/genericLocks"},"locationLocks":{"$ref":"#/definitions/locks/genericLocks"},"valueScaleLocks":{"$ref":"#/definitions/locks/valueScaleLocks"},"views":{"type":"array","items":{"$ref":"#/definitions/view"},"minLength":1},"chromInfoPath":{"type":"string"}},"definitions":{"data":{"type":"object","properties":{"type":{"type":"string"},"tilesetInfo":{"type":"object"},"children":{"type":"array"},"tiles":{"type":"object"}}},"locks":{"slug":{"type":"string"},"locksByViewUid":{"type":"object","additionalProperties":false,"patternProperties":{".":{"$ref":"#/definitions/locks/slug"}}},"genericLocks":{"type":"object","additionalProperties":false,"required":[],"properties":{"locksByViewUid":{"$ref":"#/definitions/locks/locksByViewUid"},"locksDict":{"type":"object","additionalProperties":false,"patternProperties":{".":{"type":"object","additionalProperties":false,"properties":{"uid":{"$ref":"#/definitions/locks/slug"}},"patternProperties":{"^(?!uid).":{"type":"array","minLength":3,"maxLength":3,"items":{"type":"number"}}}}}}}},"valueScaleLocks":{"type":"object","additionalProperties":false,"required":["locksByViewUid","locksDict"],"properties":{"locksByViewUid":{"$ref":"#/definitions/locks/locksByViewUid"},"locksDict":{"type":"object","additionalProperties":false,"patternProperties":{".":{"type":"object","additionalProperties":false,"properties":{"uid":{"$ref":"#/definitions/locks/slug"},"ignoreOffScreenValues":{"type":"boolean"}},"patternProperties":{"^(?!(uid|ignoreOffScreenValues)).":{"type":"object","additionalProperties":false,"required":["view","track"],"properties":{"view":{"type":"string"},"track":{"$ref":"#/definitions/locks/slug"}}}}}}}}}},"view":{"type":"object","additionalProperties":false,"required":["tracks","layout"],"properties":{"autocompleteSource":{"type":"string"},"chromInfoPath":{"type":"string"},"genomePositionSearchBox":{"$ref":"#/definitions/viewProperties/genomePositionSearchBox"},"genomePositionSearchBoxVisible":{"type":"boolean"},"initialXDomain":{"$ref":"#/definitions/viewProperties/domain"},"initialYDomain":{"$ref":"#/definitions/viewProperties/domain"},"layout":{"$ref":"#/definitions/viewProperties/layout"},"overlays":{"type":"array","items":{"$ref":"#/definitions/viewProperties/overlay"}},"selectionView":{"type":"boolean"},"tracks":{"$ref":"#/definitions/viewProperties/tracks_object"},"uid":{"type":"string"},"zoomFixed":{"type":"boolean"}}},"viewProperties":{"genomePositionSearchBox":{"type":"object","title":"The Genome Position Search Box Schema","required":["chromInfoServer","chromInfoId"],"properties":{"autocompleteServer":{"type":"string","title":"The Autocomplete Server URL","default":"","examples":["//higlass.io/api/v1"],"pattern":"^(.*)$"},"autocompleteId":{"type":"string","title":"The Autocomplete ID","default":"","examples":["OHJakQICQD6gTD7skx4EWA"],"pattern":"^(.*)$"},"chromInfoServer":{"type":"string","title":"The Chrominfo Server URL","default":"","examples":["//higlass.io/api/v1"],"pattern":"^(.*)$"},"chromInfoId":{"type":"string","title":"The Chromosome Info ID","default":"","examples":["hg19"],"pattern":"^(.*)$"},"visible":{"type":"boolean","title":"The Visible Schema","default":false}}},"overlay":{"type":"object","additionalProperties":false,"properties":{"chromInfoPath":{"type":"string"},"includes":{"type":"array"},"options":{"type":"object","properties":{"extent":{"type":"array"},"minWidth":{"type":"number"},"fill":{"type":"string"},"fillOpacity":{"type":"number"},"stroke":{"type":"string"},"strokeOpacity":{"type":"number"},"strokeWidth":{"type":"number"},"strokePos":{"type":["string","array"]},"outline":{"type":"string"},"outlineOpacity":{"type":"number"},"outlineWidth":{"type":"number"},"outlinePos":{"type":["string","array"]}}},"type":{"type":"string"},"uid":{"type":"string"}}},"layout":{"type":"object","additionalProperties":false,"required":["w","h","x","y"],"properties":{"x":{"type":"integer","title":"The X Position","default":0},"y":{"type":"integer","title":"The Y Position","default":0},"w":{"type":"integer","title":"Width","default":12},"h":{"type":"integer","title":"Height","default":12}}},"tracks_object":{"type":"object","additionalProperties":false,"properties":{"left":{"$ref":"#/definitions/viewProperties/tracks_array"},"right":{"$ref":"#/definitions/viewProperties/tracks_array"},"top":{"$ref":"#/definitions/viewProperties/tracks_array"},"bottom":{"$ref":"#/definitions/viewProperties/tracks_array"},"center":{"$ref":"#/definitions/viewProperties/tracks_array"},"whole":{"$ref":"#/definitions/viewProperties/tracks_array"},"gallery":{"$ref":"#/definitions/viewProperties/tracks_array"}}},"tracks_array":{"type":"array","items":{"oneOf":[{"$ref":"#/definitions/tracks/enum_track"},{"$ref":"#/definitions/tracks/combined_track"},{"$ref":"#/definitions/tracks/heatmap_track"},{"$ref":"#/definitions/tracks/independent_viewport_projection_track"}]}},"domain":{"type":"array","items":{"type":"number"},"maxItems":2,"minItems":2}},"tracks":{"heatmap_track":{"type":"object","additionalProperties":false,"required":[],"properties":{"uid":{"type":"string"},"type":{"const":"heatmap"},"data":{"$ref":"#/definitions/data"},"height":{"type":"number"},"options":{"type":"object"},"position":{"type":"string"},"server":{"type":"string"},"tilesetUid":{"type":"string"},"width":{"type":"number"}}},"combined_track":{"type":"object","additionalProperties":false,"required":["contents"],"properties":{"contents":{"$ref":"#/definitions/viewProperties/tracks_array"},"height":{"type":"number"},"options":{},"position":{"type":"string"},"type":{"const":"combined"},"uid":{"type":"string"},"width":{"type":"number"}}},"enum_track":{"type":"object","additionalProperties":false,"required":["type"],"properties":{"server":{"type":"string"},"tilesetUid":{"type":"string"},"data":{"$ref":"#/definitions/data"},"uid":{"type":"string"},"type":{"enum":["2d-annotations","2d-chromosome-annotations","2d-chromosome-grid","2d-chromosome-labels","2d-rectangle-domains","2d-tiles","arrowhead-domains","bedlike","cross-rule","dummy","horizontal-1d-annotations","horizontal-1d-heatmap","horizontal-1d-tiles","horizontal-1d-value-interval","horizontal-2d-rectangle-domains","horizontal-bar","horizontal-chromosome-grid","horizontal-chromosome-labels","horizontal-divergent-bar","horizontal-gene-annotations","horizontal-heatmap","horizontal-line","horizontal-multivec","horizontal-point","horizontal-rule","horizontal-vector-heatmap","image-tiles","left-axis","left-stacked-interval","mapbox-tiles","osm-2d-tile-ids","osm-tiles","raster-tiles","simple-svg","square-markers","top-axis","top-stacked-interval","vertical-1d-annotations","vertical-1d-heatmap","vertical-1d-tiles","vertical-1d-value-interval","vertical-2d-rectangle-domains","vertical-bar","vertical-bedlike","vertical-chromosome-grid","vertical-chromosome-labels","vertical-gene-annotations","vertical-heatmap","vertical-line","vertical-multivec","vertical-point","vertical-rule","vertical-vector-heatmap","viewport-projection-center","viewport-projection-horizontal","viewport-projection-vertical"]},"chromInfoPath":{"type":"string"},"fromViewUid":{"type":"string"},"height":{"type":"number"},"options":{"type":"object"},"width":{"type":"number"},"x":{"type":"number"},"y":{"type":"number"}}},"independent_viewport_projection_track":{"type":"object","additionalProperties":false,"properties":{"uid":{"type":"string"},"type":{"enum":["viewport-projection-horizontal","viewport-projection-vertical","viewport-projection-center"]},"fromViewUid":{"type":"null"},"projectionXDomain":{"$ref":"#/definitions/viewProperties/domain"},"projectionYDomain":{"$ref":"#/definitions/viewProperties/domain"},"options":{"type":"object"},"transforms":{"type":"array"},"width":{"type":"number"},"x":{"type":"number"},"y":{"type":"number"}}}}}}')},430:function(t,e,n){t.exports=n(653)},435:function(t,e,n){},650:function(t,e,n){},653:function(t,e,n){"use strict";n.r(e);var i=n(3),r=n.n(i),a=n(72),o=n.n(a),l=(n(435),n(92)),c=n(120),s=n(364),d=n(50),g=n(368),u=n.n(g),h=(n(193),n(372));var p=function(t){var e=t.code,n=t.readOnly,a=Object(i.useRef)(null),o=Object(i.useState)(e),l=Object(c.a)(o,2),s=l[0],d=l[1];return Object(i.useEffect)((function(){d(e)}),[e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{handleWidth:!0,handleHeight:!0,onResize:function(t,e){var n;null===a||void 0===a||null===(n=a.current)||void 0===n||n.layout({width:t,height:e})}}),r.a.createElement(u.a,{language:"json",value:s,theme:"test",options:{autoClosingBrackets:"never",autoClosingQuotes:"never",cursorBlinking:"smooth",folding:!0,lineNumbersMinChars:4,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",lineNumbers:"off",renderLineHighlight:"line",renderIndentGuides:!0,readOnly:n},onChange:function(e,n){d(e),t.onChange&&t.onChange(e)},editorDidMount:function(t,e){a.current=t,t.focus()},editorWillMount:function(t){}}))},y=n(209),f=n.n(y),m=n(296),b=n(200),v=n.n(b),k=n(226),x=n.n(k),w=[{name:"glyph-gene-annotation-v1",mark:{type:"compositeMark",name:"gene-annotation",requiredChannels:["x","xe","y","color","geneOrExon","exonId","exonVersion"],elements:[{description:"horizontal line",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:"line",color:{value:"black"},size:{value:3}},{description:"exon",select:[{channel:"geneOrExon",oneOf:["exon"]},{channel:"exonVersion",oneOf:["2"]}],mark:"rect",size:{value:25}},{description:"gene left",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:{bind:"y",domain:["-","+"],range:["triangle-l","rule"]},size:{value:25},xe:"none"},{description:"gene right",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:{bind:"y",domain:["-","+"],range:["rule","triangle-r"]},size:{value:25},x:{bind:"xe"},xe:"none"},{mark:"text",select:[{channel:"geneOrExon",oneOf:["gene"]}],opacity:{value:1},size:{value:18},style:{dy:-20}},{mark:"text",select:[{channel:"geneOrExon",oneOf:["exon"]},{channel:"exonVersion",oneOf:["2"]}],text:{bind:"exonId"},opacity:{value:1},size:{value:6},style:{dy:28}}]}},{name:"glyph-gene-annotation-v2",mark:{type:"compositeMark",name:"gene-annotation",requiredChannels:["x","xe","y","color","geneOrExon"],elements:[{description:"gene",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:"rect",size:{value:25}},{description:"gene head",select:[{channel:"geneOrExon",oneOf:["gene"]},{channel:"y",oneOf:["-"]}],mark:"triangle-l",size:{value:25},xe:"none"},{description:"gene right",select:[{channel:"geneOrExon",oneOf:["gene"]},{channel:"y",oneOf:["+"]}],mark:"triangle-r",size:{value:25},x:{bind:"xe"},xe:"none"},{description:"horizontal line",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:"line",color:{value:"gray"},size:{value:2},style:{dashed:"3, 3"}},{mark:"text",select:[{channel:"geneOrExon",oneOf:["gene"]}],color:{value:"black"},opacity:{value:1},size:{value:18},style:{dy:-20}}]}},{name:"cytogenetic-band-v1",mark:{type:"compositeMark",name:"cytogenetic-band",requiredChannels:["x","xe","y","color","text","stain"],elements:[{description:"symbols",select:[{channel:"stain",oneOf:["gneg","gpos","gvar"]}],mark:"rect",size:{value:25},style:{stroke:"black",strokeWidth:1}},{description:"acen",select:[{channel:"text",oneOf:["11","11.1"]}],mark:{bind:"text",domain:["11","11.1"],range:["triangle-l","triangle-r"]},color:{value:"#B40101"},size:{value:25},style:{stroke:"black",strokeWidth:1}},{mark:"text",select:[{channel:"color",oneOf:["100","75","50"]}],color:{value:"black"},size:{value:10},style:{dy:-20}}]}},{name:"glyph-logo-plot-v1",mark:{type:"compositeMark",name:"logo",requiredChannels:["x","xe","y"],elements:[{mark:"bar"},{mark:"text",color:{value:"black"}}]}}],O=["glyph-gene-annotation-v1","glyph-gene-annotation-v2","cytogenetic-band-v1","glyph-logo-plot-v1"];function E(t){for(var e=0;e<t.tracks.length;e++){var n=t.tracks[e];P(n)&&z(n.mark)&&function(){var t,e=n.mark.type;O.includes(e)&&(n.mark=null===(t=w.find((function(t){return t.name===e})))||void 0===t?void 0:t.mark)}()}return t}function j(t){return"object"===typeof t}function P(t){return t!=={}}function z(t){return"object"===typeof t}function S(t){return"object"===typeof t&&"compositeMark"===t.type}function B(t){return"object"===typeof t.mark&&S(t.mark)&&"compositeMark"!==t.mark.type||j(t.data)&&!(!(e=t.data.url).includes("tileset_info/?d=")||!e.includes("https:")&&!e.includes("http:"));var e}function C(t){return null!==t&&"object"===typeof t&&"value"in t}function _(t){return null!==t&&"object"===typeof t&&"bind"in t}function F(t){return"object"===typeof t&&!("value"in t)}var W=n(371),D=[{name:"Gene Annotation Plot (Simple)",spec:{tracks:[{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/Homo_sapiens.GRCh38.92.glyph.csv",type:"csv"},mark:{server:"gemini.v1",type:"glyph-gene-annotation-v2"},x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},y:{field:"strand",type:"nominal"},text:{field:"gene_name",type:"nominal"},geneOrExon:{field:"feature",type:"nominal"},color:{value:"#D1D28D"},opacity:{value:.7},stroke:{value:"white"}}]},glyphWidth:300,glyphHeight:150},{name:"Gene Annotation Plot",spec:{tracks:[{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/Homo_sapiens.GRCh38.92.glyph.csv",type:"csv"},mark:{server:"gemini.v1",type:"glyph-gene-annotation-v1"},x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},y:{field:"strand",type:"nominal"},text:{field:"gene_name",type:"nominal"},color:{field:"strand",type:"nominal"},exonVersion:{field:"exon_version",type:"nominal"},geneOrExon:{field:"feature",type:"nominal"},exonId:{field:"exon_id",type:"nominal"},opacity:{value:.9}}]},glyphWidth:600,glyphHeight:150},{name:"Cytogenetic Band",spec:{tracks:[{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/chr1_cytogenetic_band.glyph.csv",type:"csv"},mark:{server:"gemini.v1",type:"cytogenetic-band-v1"},x:{field:"Basepair_start",type:"genomic"},xe:{field:"Basepair_stop",type:"genomic"},y:{field:"Chr.",type:"nominal"},text:{field:"Band",type:"nominal"},stain:{field:"Stain",type:"nominal"},color:{field:"Density",type:"nominal",domain:["","25","50","75","100"],range:["white","#D9D9D9","#979797","#636363","black"]}}]},glyphWidth:900,glyphHeight:150},{name:"Six Different Between-Links",spec:{tracks:[{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x:{field:"from",type:"nominal"},y:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x1:{field:"from",type:"nominal"},y:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x1:{field:"from",type:"nominal"},y1:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x:{field:"from",type:"nominal"},y1:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x:{field:"from",type:"nominal"},x1:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",y:{field:"from",type:"nominal"},y1:{field:"to",type:"nominal"},width:50,height:50}]},glyphWidth:0,glyphHeight:0},{name:"Between-Links (Combo)",spec:{references:["http://genocat.tools/tools/combo.html","http://genocat.tools/tools/gbrowse_syn.html","http://genocat.tools/tools/ggbio.html","http://genocat.tools/tools/give.html","http://genocat.tools/tools/variant_view.html"],tracks:[{data:{url:"dummy",type:"csv"},mark:"dummy",width:600,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x1:{field:"from",type:"nominal"},x:{field:"to",type:"nominal"},width:600,height:50},{data:{url:"dummy",type:"csv"},mark:"dummy",width:600,height:50}]},glyphWidth:0,glyphHeight:0},{name:"Between-Links (Combo, Horizontal)",spec:{layout:{type:"linear",direction:"horizontal"},tracks:[{data:{url:"dummy",type:"csv"},mark:"dummy",width:60,height:500},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",y:{field:"from",type:"nominal"},y1:{field:"to",type:"nominal"},width:60,height:500},{data:{url:"dummy",type:"csv"},mark:"dummy",width:60,height:500}]},glyphWidth:0,glyphHeight:0},{name:"Stacked Multiple Tracks",spec:{layout:{type:"linear",direction:"horizontal",wrap:2},tracks:[{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30}]},glyphWidth:0,glyphHeight:0},{name:"Stacked Multiple Tracks (Circular)",spec:{layout:{type:"circular",direction:"horizontal",wrap:2},tracks:[{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30}]},glyphWidth:0,glyphHeight:0},{name:"Between-Bands (HiGlass Tracks)",spec:{references:["http://genocat.tools/tools/combo.html","http://genocat.tools/tools/gbrowse_syn.html","http://genocat.tools/tools/ggbio.html","http://genocat.tools/tools/give.html","http://genocat.tools/tools/variant_view.html"],tracks:[{data:{url:"https://resgen.io/api/v1/tileset_info/?d=a-iBpdh3Q_uO2FLCWKpOOw",type:"tileset"},mark:"rect",x:{type:"genomic",domain:{chromosome:"9"}},width:600,height:60},{data:{url:"https://resgen.io/api/v1/tileset_info/?d=a-iBpdh3Q_uO2FLCWKpOOw",type:"tileset"},mark:"line",x:{type:"genomic"},width:600,height:60},{data:{url:"https://higlass.io/api/v1/tileset_info/?d=OHJakQICQD6gTD7skx4EWA",type:"tileset"},mark:{type:"gene-annotation-higlass",server:"gemini-v1"},x:{type:"genomic",axis:!0,domain:{chromosome:"12"}},width:600,height:120},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/range-to-range-relation.csv",type:"csv"},mark:"link-between",x1:{field:"from"},x1e:{field:"from1"},x:{field:"to"},xe:{field:"to1"},width:600,height:150,stroke:{value:"none"}},{data:{url:"https://higlass.io/api/v1/tileset_info/?d=OHJakQICQD6gTD7skx4EWA",type:"tileset"},mark:{type:"gene-annotation-higlass",server:"gemini-v1"},x:{type:"genomic"},x1:{axis:!0},width:600,height:120},{data:{url:"https://resgen.io/api/v1/tileset_info/?d=a-iBpdh3Q_uO2FLCWKpOOw",type:"tileset"},mark:"bar",x:{type:"genomic"},width:600,height:60},{data:{url:"https://resgen.io/api/v1/tileset_info/?d=a-iBpdh3Q_uO2FLCWKpOOw",type:"tileset"},mark:"point",x:{type:"genomic"},width:600,height:60}]},glyphWidth:0,glyphHeight:0}];var M=n(184),$=n(166),I=n(167);var A=function(){function t(e){Object($.a)(this,t),this.track=void 0,this.channelToField=void 0,this.domains=void 0,this.scales=void 0,this.ranges=void 0,this.track=e,this.domains={},this.channelToField={},this.scales={},this.ranges={},S(this.track.mark)&&(this.track.mark.elements=function(t){var e=[];return t.forEach((function(t){if("object"===typeof t.mark)for(var n=t.mark.bind,i=0;i<t.mark.domain.length;i++){var r=t.mark.domain[i],a=t.mark.range[i],o=t.select?t.select:[];e.push(Object(l.a)(Object(l.a)({},t),{},{mark:a,select:[].concat(Object(M.a)(o),[{channel:n,oneOf:[r]}])}))}else e.push(t)})),e}(this.track.mark.elements)),this.setDomains()}return Object(I.a)(t,[{key:"getTrack",value:function(){return this.track}},{key:"getElements",value:function(){return S(this.track.mark)?this.track.mark.elements:[]}},{key:"getFieldByChannel",value:function(t){return this.channelToField[t]}},{key:"setDomains",value:function(){var t=this,e=this.track.data;S(this.track.mark)&&(this.track.mark.requiredChannels.forEach((function(n){var i,r=t.track[n];if(F(r)){var a=r.field;if(!a)return;t.channelToField[n]=a;var o="xe"===n?"x":"ye"===n?"y":n;t.domains[o]||(t.domains[o]=[]),t.domains[o]=[].concat(Object(M.a)(t.domains[o]),Object(M.a)(r.domain&&(i=r.domain,Array.isArray(i))?r.domain:e.map((function(t){return t[a]}))))}})),Object.keys(this.domains).forEach((function(e){var n=t.track[e];if(F(n)){var i=n.type;t.domains[e]="nominal"===i?d.k(t.domains[e]).values():d.c(t.domains[e].map((function(t){return+t})))}})))}},{key:"setRanges",value:function(t){var e=this;Object.keys(this.domains).forEach((function(n){var i=e.track[n];F(i)&&("x"===n?e.ranges.x=[t.x,t.x+t.width]:"y"===n?e.ranges.y=[t.y,t.y+t.height]:"color"===n&&(e.ranges.color=i.range?i.range:d.i))}))}},{key:"setScales",value:function(t){var e=this;this.setRanges(t),Object.keys(this.domains).forEach((function(t){var n=e.track[t];if(F(n)){var i=n.type;e.ranges[t]&&(e.scales[t]="color"===t&&"nominal"===i?d.g().domain(e.domains[t]).range(e.ranges[t]):"color"===t&&"quantitative"===i?d.h(d.d).domain(e.domains[t]):"nominal"===i?d.g().domain(e.domains[t]).range(e.ranges[t]):d.f().domain(e.domains[t]).range(e.ranges[t]))}}))}},{key:"getEncoding",value:function(t,e,n,i){var r="xe"===e?"x":"ye"===e?"y":e;if(C(t[e]))switch(e){case"size":case"opacity":case"color":case"text":return t[e].value}else if(C(this.track[e]))switch(e){case"size":case"opacity":case"color":case"text":return this.track[e].value}else{if(this.scales[r]){var a=_(t[e])?this.getFieldByChannel(t[e].bind):this.getFieldByChannel(e);return this.scales[r](n[a])}if("text"!==e){if("w"===e){if(this.scales.x&&F(this.track.x)&&F(this.track.xe)&&"none"!==t.x&&"none"!==t.xe){var o=Math.abs(n[this.getFieldByChannel("xe")]-n[this.getFieldByChannel("x")]);return this.scales.x(o)}return this.getEncoding(t,"size",n)}return{opacity:1,size:10,color:"black",text:""}[e]}var l=_(t.text)?this.getFieldByChannel(t.text.bind):F(this.track.text)?this.track.text.field:void 0;if(l)return n[l]}}},{key:"getScale",value:function(t){return this.scales[t]}}]),t}();function V(t,e,n,i,r){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];d.j(t).attr("width",e).attr("height",n);var o=d.j(t).append("g");o.append("rect").attr("width",e).attr("height",n).attr("stroke","lightgray").attr("fill","white"),a&&(o.append("line").attr("x1",0).attr("x2",e).attr("y1",r).attr("y2",r).attr("class","preview-guideline"),o.append("line").attr("x1",0).attr("x2",e).attr("y1",n-r).attr("y2",n-r).attr("class","preview-guideline"),o.append("line").attr("x1",i).attr("x2",i).attr("y1",0).attr("y2",n).attr("class","preview-guideline"),o.append("line").attr("x1",e-i).attr("x2",e-i).attr("y1",0).attr("y2",n).attr("class","preview-guideline"),o.append("line").attr("x1",0).attr("x2",e).attr("y1",n/2).attr("y2",n/2).attr("class","preview-guideline"),o.append("line").attr("x1",e/2).attr("x2",e/2).attr("y1",0).attr("y2",n).attr("class","preview-guideline"))}function L(t,e,n,i){if(t&&e){d.j(t).selectAll("*").remove();var r=n,a=i;V(t,r,a,60,30),function(t,e,n){var i=new A(e);i.setScales(Object(l.a)(Object(l.a)({},n),{},{y:n.y+n.height/2}));var r=e.data;r?S(e.mark)?i.getElements().forEach((function(e){var n=e.select,a=e.mark,o=[];null===n||void 0===n||n.forEach((function(t){var e=t.channel,n=t.oneOf;i.getFieldByChannel(e)&&o.push({field:i.getFieldByChannel(e),oneOf:n})}));var l,c,s=function(t,e){var n=t.slice();return e.forEach((function(t){n=n.filter((function(e){return-1!==t.oneOf.indexOf(e[t.field])}))})),n}(r,o);if("line"===a)t.selectAll().data(s).enter().append("line").attr("x1",(function(t){return i.getEncoding(e,"x",t)})).attr("x2",(function(t){return i.getEncoding(e,"xe",t)})).attr("y1",(function(t){return i.getEncoding(e,"y",t)})).attr("y2",(function(t){return i.getEncoding(e,"y",t)})).attr("stroke",(function(t){return i.getEncoding(e,"color",t)})).attr("stroke-width",(function(t){return i.getEncoding(e,"size",t)})).attr("opacity",(function(t){return i.getEncoding(e,"opacity",t)})).style("stroke-dasharray",null!==(l=null===(c=e.style)||void 0===c?void 0:c.dashed)&&void 0!==l?l:"");else if("point"===a)t.selectAll("point").data(s).enter().append("circle").attr("fill",(function(t){return i.getEncoding(e,"color",t)})).attr("cx",(function(t){return i.getEncoding(e,"x",t)})).attr("cy",(function(t){return i.getEncoding(e,"x",t)})).attr("r",15).attr("opacity",(function(t){return i.getEncoding(e,"opacity",t)}));else if("rect"===a){var d,g,u,h;t.selectAll().data(s).enter().append("rect").attr("x",(function(t){return i.getEncoding(e,"x",t)})).attr("y",(function(t){return i.getEncoding(e,"y",t)-i.getEncoding(e,"size",t)/2})).attr("width",(function(t){return i.getEncoding(e,"xe",t)-i.getEncoding(e,"x",t)})).attr("height",(function(t){return i.getEncoding(e,"size",t)})).attr("fill",(function(t){return i.getEncoding(e,"color",t)})).attr("opacity",(function(t){return i.getEncoding(e,"opacity",t)})).attr("stroke",null!==(d=null===(g=e.style)||void 0===g?void 0:g.stroke)&&void 0!==d?d:"").attr("stroke-width",null!==(u=null===(h=e.style)||void 0===h?void 0:h.strokeWidth)&&void 0!==u?u:"")}else if("text"===a)t.selectAll().data(s).enter().append("text").text((function(t){return i.getEncoding(e,"text",t)})).attr("x",(function(t){return(i.getEncoding(e,"x",t)+i.getEncoding(e,"xe",t))/2})).attr("y",(function(t){var n;return i.getEncoding(e,"y",t)+(null===(n=e.style)||void 0===n?void 0:n.dy)})).attr("fill",(function(t){return i.getEncoding(e,"color",t)})).attr("font-size",(function(t){return i.getEncoding(e,"size",t)})).attr("alignment-baseline","top").attr("text-anchor","middle").attr("opacity",(function(t){return i.getEncoding(e,"opacity",t)}));else if("rule"===a)t.selectAll("rule").data(s).enter().append("line").attr("x1",(function(t){return i.getEncoding(e,"x",t)})).attr("x2",(function(t){return i.getEncoding(e,"x",t)})).attr("y1",(function(t){return i.getEncoding(e,"x",t)-i.getEncoding(e,"size",t)/2})).attr("y2",(function(t){return i.getEncoding(e,"x",t)-i.getEncoding(e,"size",t)/2})).attr("stroke",(function(t){return i.getEncoding(e,"color",t)})).attr("stroke-width",3).attr("opacity",(function(t){return i.getEncoding(e,"opacity",t)}));else if("triangle-r"===a){var p,y,f,m;t.selectAll("trangle-r").data(s).enter().append("path").attr("d",(function(t){var n=i.getEncoding(e,"size",t),r=i.getEncoding(e,"w",t),a=i.getEncoding(e,"x",t),o=i.getEncoding(e,"y",t);return"M".concat(a+r," ").concat(o)+"L".concat(a," ").concat(o+n/2)+"L".concat(a," ").concat(o-n/2," Z")})).attr("fill",(function(t){return i.getEncoding(e,"color",t)})).attr("opacity",(function(t){return i.getEncoding(e,"opacity",t)})).attr("stroke",null!==(p=null===(y=e.style)||void 0===y?void 0:y.stroke)&&void 0!==p?p:"").attr("stroke-width",null!==(f=null===(m=e.style)||void 0===m?void 0:m.strokeWidth)&&void 0!==f?f:"")}else if("triangle-l"===a){var b,v,k,x;t.selectAll("trangle-l").data(s).enter().append("path").attr("d",(function(t){var n=i.getEncoding(e,"size",t),r=i.getEncoding(e,"w",t),a=i.getEncoding(e,"x",t),o=i.getEncoding(e,"y",t);return"M".concat(a," ").concat(o)+"L".concat(a+r," ").concat(o+n/2)+"L".concat(a+r," ").concat(o-n/2," Z")})).attr("fill",(function(t){return i.getEncoding(e,"color",t)})).attr("opacity",(function(t){return i.getEncoding(e,"opacity",t)})).attr("stroke",null!==(b=null===(v=e.style)||void 0===v?void 0:v.stroke)&&void 0!==b?b:"").attr("stroke-width",null!==(k=null===(x=e.style)||void 0===x?void 0:x.strokeWidth)&&void 0!==k?k:"")}})):console.warn("Glyph is not defined."):console.warn("No array of a JSON object suggested.")}(d.j(t).append("g").attr("width",r-120).attr("height",a-60).attr("transform","translate(".concat(60,",").concat(30,")")),e,{x:0,width:r-120,y:0,height:a-60})}}var H=n(255),T=n(216),R={chr1:249250621,chr2:243199373,chr3:198022430,chr4:191154276,chr5:180915260,chr6:171115067,chr7:159138663,chr8:146364022,chr9:141213431,chr10:135534747,chr11:135006516,chr12:133851895,chr13:115169878,chr14:107349540,chr15:102531392,chr16:90354753,chr17:81195210,chr18:78077248,chr19:59128983,chr20:63025520,chr21:48129895,chr22:51304566,chrX:155270560,chrY:59373566,chrM:16571},q={};Object.keys(R).reduce((function(t,e){return q[e]=[t,t+R[e]],t+R[e]}),0);var G=Object.values(R).reduce((function(t,e){return t+e}),0),U=function(){function t(){Object($.a)(this,t),this.hg=void 0,this.hg={},this.setEditable(!1),this.setChromInfoPath("//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv"),this.hg.trackSourceServers=[],this.hg.views=[{uid:x.a.v1(),genomePositionSearchBoxVisible:!1,layout:{w:12,h:12,x:0,y:0},tracks:{top:[],left:[],center:[],right:[],bottom:[],gallery:[],whole:[]},initialXDomain:[0,G],initialYDomain:[0,G]}]}return Object(I.a)(t,[{key:"spec",value:function(){return this.hg}},{key:"getNumericDomain",value:function(t){if(function(t){return"chromosome"in t&&!("interval"in t)}(t))return q["chr".concat(t.chromosome)];if(function(t){return!("chromosome"in t)&&"interval"in t}(t))return t.interval;if(function(t){return"chromosome"in t&&"interval"in t}(t)){var e=q["chr".concat(t.chromosome)][0],n=Object(c.a)(t.interval,2);return[e+n[0],e+n[1]]}}},{key:"setDomain",value:function(t,e){var n,i;t&&(null===(n=this.hg.views)||void 0===n?void 0:n[0])&&(this.hg.views[0].initialXDomain=this.getNumericDomain(t)),e&&(null===(i=this.hg.views)||void 0===i?void 0:i[0])&&(this.hg.views[0].initialYDomain=this.getNumericDomain(e))}},{key:"setEditable",value:function(t){return this.hg.editable=t,this}},{key:"setChromInfoPath",value:function(t){return this.hg.chromInfoPath=t,this}},{key:"addTrackSourceServers",value:function(t){var e,n;return t&&-1===(null===(e=this.hg.trackSourceServers)||void 0===e?void 0:e.indexOf(t))&&(null===(n=this.hg.trackSourceServers)||void 0===n||n.push(t)),this}},{key:"setMainTrack",value:function(t){return this.hg.views?(this.hg.views[0].tracks.center=[t],this):this}},{key:"setAxisTrack",value:function(t){var e;if(!this.hg.views)return this;var n="left"===t||"right"===t?"vertical":"horizontal",i="vertical"===n?"width":"height";return this.hg.views[0].tracks[t]=[(e={uid:x.a.v1(),type:n+"-chromosome-labels"},Object(T.a)(e,i,20),Object(T.a)(e,"chromInfoPath",this.hg.chromInfoPath),e)],this}},{key:"validateSpec",value:function(){var t=new v.a({extendRefs:!0}).compile(H),e=t(this.spec());return t.errors&&console.warn(JSON.stringify(t.errors,null,2)),e}}]),t}(),N=["rgba(68,1,84,1)","rgba(68,2,85,1)","rgba(69,3,87,1)","rgba(69,5,88,1)","rgba(69,6,90,1)","rgba(70,8,91,1)","rgba(70,9,93,1)","rgba(70,11,94,1)","rgba(70,12,96,1)","rgba(71,14,97,1)","rgba(71,15,98,1)","rgba(71,17,100,1)","rgba(71,18,101,1)","rgba(71,20,102,1)","rgba(72,21,104,1)","rgba(72,22,105,1)","rgba(72,24,106,1)","rgba(72,25,108,1)","rgba(72,26,109,1)","rgba(72,28,110,1)","rgba(72,29,111,1)","rgba(72,30,112,1)","rgba(72,32,113,1)","rgba(72,33,115,1)","rgba(72,34,116,1)","rgba(72,36,117,1)","rgba(72,37,118,1)","rgba(72,38,119,1)","rgba(72,39,120,1)","rgba(71,41,121,1)","rgba(71,42,121,1)","rgba(71,43,122,1)","rgba(71,44,123,1)","rgba(71,46,124,1)","rgba(70,47,125,1)","rgba(70,48,126,1)","rgba(70,49,126,1)","rgba(70,51,127,1)","rgba(69,52,128,1)","rgba(69,53,129,1)","rgba(69,54,129,1)","rgba(68,56,130,1)","rgba(68,57,131,1)","rgba(68,58,131,1)","rgba(67,59,132,1)","rgba(67,60,132,1)","rgba(67,62,133,1)","rgba(66,63,133,1)","rgba(66,64,134,1)","rgba(65,65,134,1)","rgba(65,66,135,1)","rgba(65,67,135,1)","rgba(64,69,136,1)","rgba(64,70,136,1)","rgba(63,71,136,1)","rgba(63,72,137,1)","rgba(62,73,137,1)","rgba(62,74,137,1)","rgba(61,75,138,1)","rgba(61,77,138,1)","rgba(60,78,138,1)","rgba(60,79,138,1)","rgba(59,80,139,1)","rgba(59,81,139,1)","rgba(58,82,139,1)","rgba(58,83,139,1)","rgba(57,84,140,1)","rgba(57,85,140,1)","rgba(56,86,140,1)","rgba(56,87,140,1)","rgba(55,88,140,1)","rgba(55,89,140,1)","rgba(54,91,141,1)","rgba(54,92,141,1)","rgba(53,93,141,1)","rgba(53,94,141,1)","rgba(52,95,141,1)","rgba(52,96,141,1)","rgba(51,97,141,1)","rgba(51,98,141,1)","rgba(51,99,141,1)","rgba(50,100,142,1)","rgba(50,101,142,1)","rgba(49,102,142,1)","rgba(49,103,142,1)","rgba(48,104,142,1)","rgba(48,105,142,1)","rgba(47,106,142,1)","rgba(47,107,142,1)","rgba(47,108,142,1)","rgba(46,109,142,1)","rgba(46,110,142,1)","rgba(45,111,142,1)","rgba(45,112,142,1)","rgba(45,112,142,1)","rgba(44,113,142,1)","rgba(44,114,142,1)","rgba(43,115,142,1)","rgba(43,116,142,1)","rgba(43,117,142,1)","rgba(42,118,142,1)","rgba(42,119,142,1)","rgba(41,120,142,1)","rgba(41,121,142,1)","rgba(41,122,142,1)","rgba(40,123,142,1)","rgba(40,124,142,1)","rgba(40,125,142,1)","rgba(39,126,142,1)","rgba(39,127,142,1)","rgba(38,128,142,1)","rgba(38,129,142,1)","rgba(38,130,142,1)","rgba(37,131,142,1)","rgba(37,131,142,1)","rgba(37,132,142,1)","rgba(36,133,142,1)","rgba(36,134,142,1)","rgba(35,135,142,1)","rgba(35,136,142,1)","rgba(35,137,142,1)","rgba(34,138,141,1)","rgba(34,139,141,1)","rgba(34,140,141,1)","rgba(33,141,141,1)","rgba(33,142,141,1)","rgba(33,143,141,1)","rgba(32,144,141,1)","rgba(32,145,140,1)","rgba(32,146,140,1)","rgba(32,147,140,1)","rgba(31,147,140,1)","rgba(31,148,140,1)","rgba(31,149,139,1)","rgba(31,150,139,1)","rgba(31,151,139,1)","rgba(30,152,139,1)","rgba(30,153,138,1)","rgba(30,154,138,1)","rgba(30,155,138,1)","rgba(30,156,137,1)","rgba(30,157,137,1)","rgba(30,158,137,1)","rgba(30,159,136,1)","rgba(30,160,136,1)","rgba(31,161,136,1)","rgba(31,162,135,1)","rgba(31,163,135,1)","rgba(31,163,134,1)","rgba(32,164,134,1)","rgba(32,165,134,1)","rgba(33,166,133,1)","rgba(33,167,133,1)","rgba(34,168,132,1)","rgba(35,169,131,1)","rgba(35,170,131,1)","rgba(36,171,130,1)","rgba(37,172,130,1)","rgba(38,173,129,1)","rgba(39,174,129,1)","rgba(40,175,128,1)","rgba(41,175,127,1)","rgba(42,176,127,1)","rgba(43,177,126,1)","rgba(44,178,125,1)","rgba(46,179,124,1)","rgba(47,180,124,1)","rgba(48,181,123,1)","rgba(50,182,122,1)","rgba(51,183,121,1)","rgba(53,183,121,1)","rgba(54,184,120,1)","rgba(56,185,119,1)","rgba(57,186,118,1)","rgba(59,187,117,1)","rgba(61,188,116,1)","rgba(62,189,115,1)","rgba(64,190,114,1)","rgba(66,190,113,1)","rgba(68,191,112,1)","rgba(70,192,111,1)","rgba(72,193,110,1)","rgba(73,194,109,1)","rgba(75,194,108,1)","rgba(77,195,107,1)","rgba(79,196,106,1)","rgba(81,197,105,1)","rgba(83,198,104,1)","rgba(85,198,102,1)","rgba(88,199,101,1)","rgba(90,200,100,1)","rgba(92,201,99,1)","rgba(94,201,98,1)","rgba(96,202,96,1)","rgba(98,203,95,1)","rgba(101,204,94,1)","rgba(103,204,92,1)","rgba(105,205,91,1)","rgba(108,206,90,1)","rgba(110,206,88,1)","rgba(112,207,87,1)","rgba(115,208,85,1)","rgba(117,208,84,1)","rgba(119,209,82,1)","rgba(122,210,81,1)","rgba(124,210,79,1)","rgba(127,211,78,1)","rgba(129,212,76,1)","rgba(132,212,75,1)","rgba(134,213,73,1)","rgba(137,213,72,1)","rgba(139,214,70,1)","rgba(142,215,68,1)","rgba(144,215,67,1)","rgba(147,216,65,1)","rgba(149,216,63,1)","rgba(152,217,62,1)","rgba(155,217,60,1)","rgba(157,218,58,1)","rgba(160,218,57,1)","rgba(163,219,55,1)","rgba(165,219,53,1)","rgba(168,220,51,1)","rgba(171,220,50,1)","rgba(173,221,48,1)","rgba(176,221,46,1)","rgba(179,221,45,1)","rgba(181,222,43,1)","rgba(184,222,41,1)","rgba(187,223,39,1)","rgba(189,223,38,1)","rgba(192,223,36,1)","rgba(195,224,35,1)","rgba(197,224,33,1)","rgba(200,225,32,1)","rgba(203,225,30,1)","rgba(205,225,29,1)","rgba(208,226,28,1)","rgba(211,226,27,1)","rgba(213,226,26,1)","rgba(216,227,25,1)","rgba(219,227,24,1)","rgba(221,227,24,1)","rgba(224,228,24,1)","rgba(226,228,24,1)","rgba(229,228,24,1)","rgba(232,229,25,1)","rgba(234,229,25,1)","rgba(237,229,26,1)","rgba(239,230,27,1)","rgba(242,230,28,1)","rgba(244,230,30,1)","rgba(247,230,31,1)","rgba(249,231,33,1)","rgba(251,231,35,1)","rgba(254,231,36,1)"];function Q(t,e){var n,i=new U;if(B(t)&&j(t.data)){var r=(n=t.data.url).includes("tileset_info/?d=")&&(n.includes("https:")||n.includes("http:"))?{server:n.split("tileset_info/?d=")[0],tilesetUid:n.split("tileset_info/?d=")[1]}:(console.warn("Data url format is incorrect:"+n),{server:void 0,tilesetUid:void 0}),a=r.server,o=r.tilesetUid,l=F(t.x)&&"genomic"===t.x.type,c=F(t.y)&&"genomic"===t.y.type,s=l&&F(t.x)?t.x.domain:void 0,d=c&&F(t.y)?t.y.domain:void 0,g=l&&c?"both":l?"horizontal":"vertical",u="object"!==typeof t.mark?t.mark:z(t.mark)?t.mark.type:"unknown";i.setDomain(s,d);var h={"gene-annotation-higlass":"".concat(g,"-gene-annotations"),point:"".concat(g,"-point"),bar:"".concat(g,"-bar"),line:"".concat(g,"-line"),rect:"".concat(g,"-1d-heatmap")},p={point:{pointColor:"#0072B2",labelPosition:"hidden",axisPositionHorizontal:"left"},bar:{barFillColor:"#0072B2",labelPosition:"hidden",axisPositionHorizontal:"left"},line:{lineStrokeColor:"#0072B2",labelPosition:"hidden",axisPositionHorizontal:"left"},rect:{colorRange:N,labelPosition:"hidden"}},y=h[u];if(!y)return{};i.setMainTrack({type:y,server:a,tilesetUid:o,width:e.width,height:e.height,options:p[u]}).addTrackSourceServers(a);var f={x:"bottom",x1:"top",y:"left",y1:"right"};return Object.keys(f).forEach((function(e){var n=t[e];F(n)&&n.axis&&i.setAxisTrack(f[e])})),i.validateSpec(),console.log("HiGlass viewConfig:",i.spec()),i.spec()}return{}}var J=function(){function t(e){Object($.a)(this,t),this.validity=void 0,this.validity={msg:"No message",isValid:e||!1}}return Object(I.a)(t,[{key:"getValidity",value:function(){return this.validity}},{key:"isValid",value:function(){return this.validity.isValid}},{key:"setMsg",value:function(t){return this.validity.msg=t,this}},{key:"setIsValid",value:function(t){return this.validity.isValid=t,this}},{key:"setValidity",value:function(t){return this.setIsValid(t.isValid),this.setMsg(t.msg),this}},{key:"printValidity",value:function(){this.getValidity().isValid?console.log(this.validity.msg):console.warn(this.validity.msg)}}]),t}();var X={fill:"lightgray",stroke:"gray",strokeWidth:1,opacity:.7},Y={color:"fill",stroke:"stroke",strokeWidth:"strokeWidth",opacity:"opacity"},K=function(){function t(e){var n=this;Object($.a)(this,t),this.style=void 0,this.style=Object(l.a)({},X),Object.keys(Y).forEach((function(t){var i=e[t];C(i)&&(n.style[Y[t]]=i.value)}))}return Object(I.a)(t,[{key:"getStyle",value:function(){return this.style}}]),t}();function Z(t){var e=F(t.x)?t.x.field:void 0,n=F(t.x1)?t.x1.field:void 0,i=F(t.y)?t.y.field:void 0,r=F(t.y1)?t.y1.field:void 0;return e&&i?"left-bottom":n&&i?"left-top":n&&r?"top-right":e&&r?"right-bottom":e&&n?"top-bottom":i&&r?"left-right":"unknown"}function tt(t,e){e.forEach((function(e){var n=function(t){var e=new J(!0),n=[F(t.x)?t.x.field:void 0,F(t.x1)?t.x1.field:void 0,F(t.y)?t.y.field:void 0,F(t.y1)?t.y1.field:void 0].filter((function(t){return t}));return n.length<2?(e.setMsg("Less than two fields are specified for a `link-between` mark."),e.setIsValid(!1)):n.length>2&&e.setMsg("More than two fields are specified for a `link-between` mark."),e}(e.track);if(n.isValid())switch(function(t){var e=F(t.x)?t.x.field:void 0,n=F(t.xe)?t.xe.field:void 0,i=F(t.x1)?t.x1.field:void 0,r=F(t.x1e)?t.x1e.field:void 0,a=F(t.y)?t.y.field:void 0,o=F(t.ye)?t.ye.field:void 0,l=F(t.y1)?t.y1.field:void 0,c=F(t.y1e)?t.y1e.field:void 0,s={x:[e,n].filter((function(t){return t})).length,xe:[i,r].filter((function(t){return t})).length,y:[a,o].filter((function(t){return t})).length,ye:[l,c].filter((function(t){return t})).length};return"link-between"===t.mark?Object.keys(s).map((function(t){return s[t]})).filter((function(t){return t>=2})).length>=2?"band-connection":"line-connection":"unknown"}(e.track)){case"line-connection":j(e.track.data)&&d.b(e.track.data.url).then((function(n){return function(t,e,n){var i=new K(e),r=F(e.x)?e.x.field:void 0,a=F(e.x1)?e.x1.field:void 0,o=F(e.y)?e.y.field:void 0,l=F(e.y1)?e.y1.field:void 0,s=[r,a,o,l].filter((function(t){return t})),g=Object(c.a)(s,2),u=g[0],h=g[1],p=d.f().domain([0,99]).range([n.x,n.x+n.width]),y=d.f().domain([0,99]).range([n.y,n.y+n.height]),f=[],m=Z(e);m.includes("left")&&f.push({x:function(){return n.x},y:function(t){return y(t[o])}}),m.includes("bottom")&&f.push({x:function(t){return p(t[r])},y:function(){return n.y+n.height}}),m.includes("top")&&f.push({x:function(t){return p(t[a])},y:function(){return n.y}}),m.includes("right")&&f.push({x:function(){return n.x+n.width},y:function(t){return y(t[l])}}),t.selectAll(".line").data(e.data).enter().filter((function(t){return Math.abs(t[u]-t[h])<30})).append("line").attr("x1",(function(t){return f[0].x(t)})).attr("y1",(function(t){return f[0].y(t)})).attr("x2",(function(t){return f[1].x(t)})).attr("y2",(function(t){return f[1].y(t)})).attr("fill",i.getStyle().fill).attr("stroke",i.getStyle().stroke).attr("stroke-width",i.getStyle().strokeWidth).attr("opacity",i.getStyle().opacity)}(t,Object(l.a)(Object(l.a)({},e.track),{},{data:n}),e.boundingBox)}));break;case"band-connection":j(e.track.data)&&d.b(e.track.data.url).then((function(n){return function(t,e,n){var i=new K(e),r=F(e.x)?e.x.field:void 0,a=F(e.xe)?e.xe.field:void 0,o=F(e.x1)?e.x1.field:void 0,l=F(e.x1e)?e.x1e.field:void 0,c=F(e.y)?e.y.field:void 0,s=F(e.ye)?e.ye.field:void 0,g=F(e.y1)?e.y1.field:void 0,u=F(e.y1e)?e.y1e.field:void 0,h=d.f().domain([0,99]).range([n.x,n.x+n.width]),p=d.f().domain([0,99]).range([n.y,n.y+n.height]),y=[],f=Z(e);f.includes("left")&&y.push({x:function(){return n.x},xe:function(){return n.x},y:function(t){return p(t[c])},ye:function(t){return p(t[s])}}),f.includes("bottom")&&y.push({x:function(t){return h(t[r])},xe:function(t){return h(t[a])},y:function(){return n.y+n.height},ye:function(){return n.y+n.height}}),f.includes("top")&&y.push({x:function(t){return h(t[o])},xe:function(t){return h(t[l])},y:function(){return n.y},ye:function(){return n.y}}),f.includes("right")&&y.push({x:function(){return n.x+n.width},xe:function(){return n.x+n.width},y:function(t){return p(t[g])},ye:function(t){return p(t[u])}}),t.selectAll(".polygon").data(e.data).enter().append("polygon").attr("points",(function(t){var e="".concat(y[0].x(t),",").concat(y[0].y(t)),n="".concat(y[0].xe(t),",").concat(y[0].ye(t)),i="".concat(y[1].xe(t),",").concat(y[1].ye(t)),r="".concat(y[1].x(t),",").concat(y[1].y(t));return"".concat(e," ").concat(n," ").concat(i," ").concat(r)})).attr("fill",i.getStyle().fill).attr("stroke",i.getStyle().stroke).attr("stroke-width",i.getStyle().strokeWidth).attr("opacity",i.getStyle().opacity)}(t,Object(l.a)(Object(l.a)({},e.track),{},{data:n}),e.boundingBox)}))}else n.printValidity()}))}function et(t,e,n,i){var r,a,o,l=null!==(r=null===(a=e.layout)||void 0===a?void 0:a.wrap)&&void 0!==r?r:999,c=[],s=i.x,d=i.y;"horizontal"===(null===(o=e.layout)||void 0===o?void 0:o.direction)?e.tracks.forEach((function(t,e){P(t)&&(c.push({track:t,boundingBox:{x:s,width:t.width,y:d,height:t.height}}),s+=t.width+3,e%l===l-1&&(s=i.x,d=d+=t.height+3))})):e.tracks.forEach((function(t,e){P(t)&&(c.push({track:t,boundingBox:{x:s,width:t.width,y:d,height:t.height}}),d+=t.height+3,e%l===l-1&&(s=s+=t.width+3,d=i.y))})),t.selectAll("rect").data(c).enter().append("rect").attr("x",(function(t){return t.boundingBox.x})).attr("width",(function(t){return t.boundingBox.width})).attr("y",(function(t){return t.boundingBox.y})).attr("height",(function(t){return t.boundingBox.height})).attr("fill",(function(t){return nt.background(t.track)})).attr("stroke",(function(t){return nt.stroke(t.track)})).attr("stroke-width",(function(t){return nt.strokeWidth(t.track)})),tt(t,c.filter((function(t){return"link-between"===t.track.mark}))),function(t,e,n){var i=[];e.forEach((function(t){var e=t.track,n=t.boundingBox;i.push({boundingBox:n,viewConfig:Q(e,n)})})),n(i)}(0,c.filter((function(t){return B(t.track)})),n)}var nt={background:function(t){var e,n;return null!==(e=null===(n=t.style)||void 0===n?void 0:n.background)&&void 0!==e?e:"white"},stroke:function(t){var e,n;return null!==(e=null===(n=t.style)||void 0===n?void 0:n.stroke)&&void 0!==e?e:"#377FB8"},strokeWidth:function(t){var e,n;return null!==(e=null===(n=t.style)||void 0===n?void 0:n.strokeWidth)&&void 0!==e?e:1}};function it(t,e,n,i){var r;t.selectAll("*").remove(),"circular"===(null===(r=e.layout)||void 0===r?void 0:r.type)?function(t,e,n,i){var r,a,o,l,c=null!==(r=null===(a=e.layout)||void 0===a?void 0:a.wrap)&&void 0!==r?r:999,s=i.height/2,g=d.l("horizontal"===(null===(o=e.layout)||void 0===o?void 0:o.direction)?e.tracks.filter((function(t,e){return e<c})).map((function(t){return P(t)?t.width:0})):e.tracks.filter((function(t,e){return e%c==0})).map((function(t){return P(t)?t.width:0}))),u=2*Math.PI/160,h=[],p=0,y=0;"horizontal"===(null===(l=e.layout)||void 0===l?void 0:l.direction)?e.tracks.forEach((function(t,e){if(P(t)){var n=t.height,i=t.width,r=2*Math.PI*y/g+u,a=r+2*Math.PI*i/g-u;h.push({track:t,arc:{innerRadius:s-p-n,outerRadius:s-p,startAngle:r,endAngle:a}}),y+=i,e%c===c-1&&(y=0,p+=n+3)}})):e.tracks.forEach((function(t,e){if(P(t)){var n=t.height,i=t.width,r=2*Math.PI*y/g+u,a=r+2*Math.PI*i/g-u;h.push({track:t,arc:{innerRadius:s-p-n,outerRadius:s-p,startAngle:r,endAngle:a}}),p+=n+3,e%c===c-1&&(p=0,y+=i)}})),console.log("arcs",h),t.append("g").attr("transform","translate(".concat(i.x+s,", ").concat(i.y+s,")")).selectAll("path").data(h).enter().append("path").attr("fill",(function(t){return nt.background(t.track)})).attr("stroke",(function(t){return nt.stroke(t.track)})).attr("stroke-width",(function(t){return nt.strokeWidth(t.track)})).attr("d",(function(t){return d.a().innerRadius(t.arc.innerRadius).outerRadius(t.arc.outerRadius)(t.arc)}))}(t,e,0,i):et(t,e,n,i)}function rt(t){var e,n,i,r,a={width:0,height:0},o=null!==(e=null===(n=t.layout)||void 0===n?void 0:n.wrap)&&void 0!==e?e:999;return"circular"===(null===(i=t.layout)||void 0===i?void 0:i.type)?(a.height=300,a.height+=d.l(t.tracks.filter((function(t,e){return e%o===0})).map((function(t){return P(t)?t.height:0}))),a.width=a.height):"horizontal"===(null===(r=t.layout)||void 0===r?void 0:r.direction)?(a.width=d.l(t.tracks.filter((function(t,e){return e<o})).map((function(t){return P(t)?t.width:0}))),a.height=d.l(t.tracks.filter((function(t,e){return e%o===0})).map((function(t){return P(t)?t.height:0}))),a.width+=3*d.e([o-1,t.tracks.length-1]),a.height+=3*Math.floor(t.tracks.length/o)):(a.width=d.l(t.tracks.filter((function(t,e){return e%o===0})).map((function(t){return P(t)?t.width:0}))),a.height=d.l(t.tracks.filter((function(t,e){return e<o})).map((function(t){return P(t)?t.height:0}))),a.width+=3*Math.floor(t.tracks.length/o),a.height+=3*d.e([o-1,t.tracks.length-1])),a}n(650);var at=D.length-1;var ot=function(){var t=Object(i.useRef)(null),e=Object(i.useRef)(null),n=Object(i.useState)([]),a=Object(c.a)(n,2),o=a[0],g=a[1],u=Object(i.useState)(D[at]),h=Object(c.a)(u,2),y=h[0],b=h[1],v=Object(i.useState)("Full Glyph Definition"),k=Object(c.a)(v,2),x=k[0],w=k[1],O=Object(i.useState)(f()(D[at].spec)),S=Object(c.a)(O,2),B=S[0],C=S[1],_=Object(i.useState)(D[at].glyphWidth),F=Object(c.a)(_,2),M=F[0],$=F[1],I=Object(i.useState)(D[at].glyphHeight),A=Object(c.a)(I,2),H=A[0],T=A[1];Object(i.useEffect)((function(){C("Full Glyph Definition"===x?f()(E(JSON.parse(f()(y.spec)))):f()(y.spec)),$(y.glyphWidth),T(y.glyphHeight),g([])}),[y,x]),Object(i.useEffect)((function(){var n,i,r;try{r=E(JSON.parse(B))}catch(o){console.warn("Cannnot parse the edited code.")}if(r){!function(t,e,n,i){if(t&&e){d.j(t).selectAll("*").remove();var r=n.x,a=n.y;V(t,n.width+2*r,n.height+2*a,r,a,!1),it(d.j(t).append("g").attr("width",n.width).attr("height",n.height),e,i,n)}}(e.current,r,{x:60,y:60,width:rt(r).width,height:rt(r).height},(function(t){g(t)})),d.j(t.current).selectAll("*").remove();var a=null===(n=r)||void 0===n||null===(i=n.tracks)||void 0===i?void 0:i.find((function(t){return!(!P(t)||!z(t.mark))&&"compositeMark"===t.mark.type}));a&&P(a)&&j(a.data)&&d.b(a.data.url).then((function(e){return L(t.current,Object(l.a)(Object(l.a)({},a),{},{data:e}),M,H)}))}}),[B,M,H]);var R=Object(i.useMemo)((function(){return o.map((function(t){return r.a.createElement("div",{key:f()(t.viewConfig),style:{position:"absolute",display:"block",left:t.boundingBox.x,top:t.boundingBox.y,width:t.boundingBox.width,height:t.boundingBox.height}},r.a.createElement(s.HiGlassComponent,{options:{bounded:!0,containerPaddingX:0,containerPaddingY:0,viewMarginTop:0,viewMarginBottom:0,viewMarginLeft:0,viewMarginRight:0,viewPaddingTop:0,viewPaddingBottom:0,viewPaddingLeft:0,viewPaddingRight:0,sizeMode:"bounded"},viewConfig:t.viewConfig}))}))}),[o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"demo-navbar"},"\ud83e\uddec Gemini ",r.a.createElement("code",null,"Editor"),r.a.createElement("select",{onChange:function(t){b(D.find((function(e){return e.name===t.target.value})))},defaultValue:y.name},D.map((function(t){return r.a.createElement("option",{key:t.name,value:t.name},t.name)}))),r.a.createElement("select",{onChange:function(t){w(t.target.value)},defaultValue:"Full Glyph Definition"},["Full Glyph Definition","Predefined Glyph"].map((function(t){return r.a.createElement("option",{key:t,value:t},t)})))),r.a.createElement("div",{className:"editor"},r.a.createElement(m.a,{split:"vertical",defaultSize:"50%",onChange:function(){}},r.a.createElement(p,{code:B,readOnly:!1,onChange:Object(W.debounce)((function(t){C(t)}),1e3)}),r.a.createElement(m.a,{split:"horizontal",defaultSize:"20%",onChange:function(){}},r.a.createElement("div",{className:"preview-container"},r.a.createElement("b",null,"Composite Mark Preview"),r.a.createElement("div",null,r.a.createElement("svg",{ref:t}))),r.a.createElement("div",{className:"preview-container"},r.a.createElement("b",null,"Layout Preview"),r.a.createElement("div",{style:{position:"relative"}},r.a.createElement("svg",{ref:e}),R))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ot,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[430,1,2]]]);
//# sourceMappingURL=main.df2ff00a.chunk.js.map