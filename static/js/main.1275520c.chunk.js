(this.webpackJsonpgemini=this.webpackJsonpgemini||[]).push([[0],{269:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://higlass.io/#viewconf","title":"HiGlass viewconf","type":"object","additionalProperties":false,"required":[],"properties":{"editable":{"type":"boolean","default":true},"viewEditable":{"type":"boolean","default":true},"tracksEditable":{"type":"boolean","default":true},"zoomFixed":{"type":"boolean"},"exportViewUrl":{"type":"string"},"trackSourceServers":{"type":"array","items":{"type":"string"},"minLength":1},"zoomLocks":{"$ref":"#/definitions/locks/genericLocks"},"locationLocks":{"$ref":"#/definitions/locks/genericLocks"},"valueScaleLocks":{"$ref":"#/definitions/locks/valueScaleLocks"},"views":{"type":"array","items":{"$ref":"#/definitions/view"},"minLength":1},"chromInfoPath":{"type":"string"}},"definitions":{"data":{"type":"object","properties":{"type":{"type":"string"},"tilesetInfo":{"type":"object"},"children":{"type":"array"},"tiles":{"type":"object"}}},"locks":{"slug":{"type":"string"},"locksByViewUid":{"type":"object","additionalProperties":false,"patternProperties":{".":{"$ref":"#/definitions/locks/slug"}}},"genericLocks":{"type":"object","additionalProperties":false,"required":[],"properties":{"locksByViewUid":{"$ref":"#/definitions/locks/locksByViewUid"},"locksDict":{"type":"object","additionalProperties":false,"patternProperties":{".":{"type":"object","additionalProperties":false,"properties":{"uid":{"$ref":"#/definitions/locks/slug"}},"patternProperties":{"^(?!uid).":{"type":"array","minLength":3,"maxLength":3,"items":{"type":"number"}}}}}}}},"valueScaleLocks":{"type":"object","additionalProperties":false,"required":["locksByViewUid","locksDict"],"properties":{"locksByViewUid":{"$ref":"#/definitions/locks/locksByViewUid"},"locksDict":{"type":"object","additionalProperties":false,"patternProperties":{".":{"type":"object","additionalProperties":false,"properties":{"uid":{"$ref":"#/definitions/locks/slug"},"ignoreOffScreenValues":{"type":"boolean"}},"patternProperties":{"^(?!(uid|ignoreOffScreenValues)).":{"type":"object","additionalProperties":false,"required":["view","track"],"properties":{"view":{"type":"string"},"track":{"$ref":"#/definitions/locks/slug"}}}}}}}}}},"view":{"type":"object","additionalProperties":false,"required":["tracks","layout"],"properties":{"autocompleteSource":{"type":"string"},"chromInfoPath":{"type":"string"},"genomePositionSearchBox":{"$ref":"#/definitions/viewProperties/genomePositionSearchBox"},"genomePositionSearchBoxVisible":{"type":"boolean"},"initialXDomain":{"$ref":"#/definitions/viewProperties/domain"},"initialYDomain":{"$ref":"#/definitions/viewProperties/domain"},"layout":{"$ref":"#/definitions/viewProperties/layout"},"overlays":{"type":"array","items":{"$ref":"#/definitions/viewProperties/overlay"}},"selectionView":{"type":"boolean"},"tracks":{"$ref":"#/definitions/viewProperties/tracks_object"},"uid":{"type":"string"},"zoomFixed":{"type":"boolean"}}},"viewProperties":{"genomePositionSearchBox":{"type":"object","title":"The Genome Position Search Box Schema","required":["chromInfoServer","chromInfoId"],"properties":{"autocompleteServer":{"type":"string","title":"The Autocomplete Server URL","default":"","examples":["//higlass.io/api/v1"],"pattern":"^(.*)$"},"autocompleteId":{"type":"string","title":"The Autocomplete ID","default":"","examples":["OHJakQICQD6gTD7skx4EWA"],"pattern":"^(.*)$"},"chromInfoServer":{"type":"string","title":"The Chrominfo Server URL","default":"","examples":["//higlass.io/api/v1"],"pattern":"^(.*)$"},"chromInfoId":{"type":"string","title":"The Chromosome Info ID","default":"","examples":["hg19"],"pattern":"^(.*)$"},"visible":{"type":"boolean","title":"The Visible Schema","default":false}}},"overlay":{"type":"object","additionalProperties":false,"properties":{"chromInfoPath":{"type":"string"},"includes":{"type":"array"},"options":{"type":"object","properties":{"extent":{"type":"array"},"minWidth":{"type":"number"},"fill":{"type":"string"},"fillOpacity":{"type":"number"},"stroke":{"type":"string"},"strokeOpacity":{"type":"number"},"strokeWidth":{"type":"number"},"strokePos":{"type":["string","array"]},"outline":{"type":"string"},"outlineOpacity":{"type":"number"},"outlineWidth":{"type":"number"},"outlinePos":{"type":["string","array"]}}},"type":{"type":"string"},"uid":{"type":"string"}}},"layout":{"type":"object","additionalProperties":false,"required":["w","h","x","y"],"properties":{"x":{"type":"integer","title":"The X Position","default":0},"y":{"type":"integer","title":"The Y Position","default":0},"w":{"type":"integer","title":"Width","default":12},"h":{"type":"integer","title":"Height","default":12}}},"tracks_object":{"type":"object","additionalProperties":false,"properties":{"left":{"$ref":"#/definitions/viewProperties/tracks_array"},"right":{"$ref":"#/definitions/viewProperties/tracks_array"},"top":{"$ref":"#/definitions/viewProperties/tracks_array"},"bottom":{"$ref":"#/definitions/viewProperties/tracks_array"},"center":{"$ref":"#/definitions/viewProperties/tracks_array"},"whole":{"$ref":"#/definitions/viewProperties/tracks_array"},"gallery":{"$ref":"#/definitions/viewProperties/tracks_array"}}},"tracks_array":{"type":"array","items":{"oneOf":[{"$ref":"#/definitions/tracks/enum_track"},{"$ref":"#/definitions/tracks/combined_track"},{"$ref":"#/definitions/tracks/heatmap_track"},{"$ref":"#/definitions/tracks/independent_viewport_projection_track"}]}},"domain":{"type":"array","items":{"type":"number"},"maxItems":2,"minItems":2}},"tracks":{"heatmap_track":{"type":"object","additionalProperties":false,"required":[],"properties":{"uid":{"type":"string"},"type":{"const":"heatmap"},"data":{"$ref":"#/definitions/data"},"height":{"type":"number"},"options":{"type":"object"},"position":{"type":"string"},"server":{"type":"string"},"tilesetUid":{"type":"string"},"width":{"type":"number"}}},"combined_track":{"type":"object","additionalProperties":false,"required":["contents"],"properties":{"contents":{"$ref":"#/definitions/viewProperties/tracks_array"},"height":{"type":"number"},"options":{},"position":{"type":"string"},"type":{"const":"combined"},"uid":{"type":"string"},"width":{"type":"number"}}},"enum_track":{"type":"object","additionalProperties":false,"required":["type"],"properties":{"server":{"type":"string"},"tilesetUid":{"type":"string"},"data":{"$ref":"#/definitions/data"},"uid":{"type":"string"},"type":{"enum":["2d-annotations","2d-chromosome-annotations","2d-chromosome-grid","2d-chromosome-labels","2d-rectangle-domains","2d-tiles","arrowhead-domains","bedlike","cross-rule","dummy","horizontal-1d-annotations","horizontal-1d-heatmap","horizontal-1d-tiles","horizontal-1d-value-interval","horizontal-2d-rectangle-domains","horizontal-bar","horizontal-chromosome-grid","horizontal-chromosome-labels","horizontal-divergent-bar","horizontal-gene-annotations","horizontal-heatmap","horizontal-line","horizontal-multivec","horizontal-point","horizontal-rule","horizontal-vector-heatmap","image-tiles","left-axis","left-stacked-interval","mapbox-tiles","osm-2d-tile-ids","osm-tiles","raster-tiles","simple-svg","square-markers","top-axis","top-stacked-interval","vertical-1d-annotations","vertical-1d-heatmap","vertical-1d-tiles","vertical-1d-value-interval","vertical-2d-rectangle-domains","vertical-bar","vertical-bedlike","vertical-chromosome-grid","vertical-chromosome-labels","vertical-gene-annotations","vertical-heatmap","vertical-line","vertical-multivec","vertical-point","vertical-rule","vertical-vector-heatmap","viewport-projection-center","viewport-projection-horizontal","viewport-projection-vertical"]},"chromInfoPath":{"type":"string"},"fromViewUid":{"type":"string"},"height":{"type":"number"},"options":{"type":"object"},"width":{"type":"number"},"x":{"type":"number"},"y":{"type":"number"}}},"independent_viewport_projection_track":{"type":"object","additionalProperties":false,"properties":{"uid":{"type":"string"},"type":{"enum":["viewport-projection-horizontal","viewport-projection-vertical","viewport-projection-center"]},"fromViewUid":{"type":"null"},"projectionXDomain":{"$ref":"#/definitions/viewProperties/domain"},"projectionYDomain":{"$ref":"#/definitions/viewProperties/domain"},"options":{"type":"object"},"transforms":{"type":"array"},"width":{"type":"number"},"x":{"type":"number"},"y":{"type":"number"}}}}}}')},472:function(e,t,i){e.exports=i(760)},477:function(e,t,i){},757:function(e,t,i){},760:function(e,t,i){"use strict";i.r(t);var n=i(3),a=i.n(n),r=i(72),o=i.n(r),l=(i(477),i(78)),s=i(120),c=i(398),d=i(152),u=i(140),h=i(141),g=i(271),p=i(153),m=i(399),f=i(411),y=i(37);function v(){return Math.ceil(Math.log(4795370/256)/Math.log(2))}function b(e){for(var t={max:null,min:null},i=0;i<e.length;i++){var n=e[i],a=n.filter((function(e){return e>=0})).reduce((function(e,t){return e+t}),0);a>t.max&&(t.max=a);var r=n.filter((function(e){return e<=0}));if(r.length>0){var o=(r=r.map((function(e){return Math.abs(e)}))).reduce((function(e,t){return e+t}),0);(null===t.min||o>t.min)&&(t.min=o)}}return t}function k(e,t){if(t){var i={min:0,max:null};return Array.from(new Set(e.map((function(e){return e.__G__})))).forEach((function(t){var n=Object(y.n)(e.filter((function(e){return e.__G__===t})).map((function(e){return e.__Q__})));i.max<n&&(i.max=n)})),i}return{min:0,max:Object(y.e)(e.map((function(e){return e.__Q__})))}}var x=i(400),w=i.n(x);var O={drawZoomInstruction:function(e,t){t.zoomInstruction||(t.zoomInstruction=new e.libraries.PIXI.Text("Zoom in to see information",{fontSize:"13px",fontFamily:"Arial",fill:"black"}),t.zoomInstruction.anchor.x=.5,t.zoomInstruction.anchor.y=.5);var i=t.pBorder;i.beginFill(15395562),i.drawRect(t.position[0],t.position[1],t.dimensions[0],t.dimensions[1]),t.zoomInstruction.x=t.position[0]+t.dimensions[0]/2,t.zoomInstruction.y=t.position[1]+t.dimensions[1]/2,i.addChild(t.zoomInstruction)},drawMultipleBarCharts:function(e,t,i){var n=e.services.pixiRenderer,a=i.graphics;i.drawnAtScale=t._xScale.copy();var r=new e.libraries.PIXI.Graphics,o=t.getTilePosAndDimensions(i.tileData.zoomLevel,i.tileData.tilePos,t.tilesetInfo.tile_size),l=o.tileX,s=o.tileWidth;t.options.barBorder&&(r.lineStyle(1,3355443,.5,0),i.barBorders=!0);var c=i.tabularData,d=(i.tileData.shape,t.options.colorScale||Object(y.h)(y.j)),u=t.dimensions[1],h=t._xScale(l+s/t.tilesetInfo.tile_size)-t._xScale(l),g=t.tilesetInfo.tile_size,p=Array.from(new Set(c.map((function(e){return e.__N__})))),m=u/p.length,f=t._xScale,v=Object(y.g)().domain([0,Object(y.e)(c.map((function(e){return e.__Q__})))]).range([0,m]),b=Object(y.h)(d).domain(p);c.forEach((function(e){var n=e.__N__,a=e.__Q__,o=e.__G__,c=b(n),d=f(l+o*s/g),u=v(a),y=m*(p.indexOf(n)+1)-u;r.beginFill(t.colorHexMap[c]),r.drawRect(d,y,h,u),t.addSVGInfo(i,d,y,h,u,c)}));var k=n.generateTexture(r,e.libraries.PIXI.SCALE_MODES.NEAREST),x=new e.libraries.PIXI.Sprite(k);x.width=f(l+s)-f(l),x.x=f(l),a.addChild(x)},drawLineCharts:function(e,t){var i=t.graphics;t.drawnAtScale=e._xScale.copy();for(var n=e.getTilePosAndDimensions(t.tileData.zoomLevel,t.tileData.tilePos,e.tilesetInfo.tile_size),a=n.tileX,r=n.tileWidth,o=t.matrix,l=e.dimensions[1],s=t.tileData.shape,c=Object(y.g)().domain([0,e.maxAndMin.max]).range([0,l]),d=0;d<o[0].length;d++){s[0];var u=l;i.lineStyle(1,e.colorHexMap[e.options.colorScale[d]],1);for(var h=0;h<o.length;h++){var g=e._xScale(a+h*r/e.tilesetInfo.tile_size),p=u-c(o[h][d]);e.addSVGInfo(t,g,p,e.options.colorScale[d]),0===h?i.moveTo(g,p):i.lineTo(g,p)}}},drawStackedBarChart:function(e,t,i){var n=e.services.pixiRenderer,a=t.mapOriginalColors(t.unFlatten(i)),r=t.maxAndMin.max,o=t.maxAndMin.min,l=t.getTilePosAndDimensions(i.tileData.zoomLevel,i.tileData.tilePos,t.tilesetInfo.tile_size),s=l.tileX,c=l.tileWidth,d=new e.libraries.PIXI.Graphics,u=t.dimensions[1],h=r+Math.abs(o),g=r*u/h,p=Math.abs(o)*u/h,m=t.dimensions[1];t.drawBackground(a,d),t.options.barBorder&&d.lineStyle(1,3355443,1,0);for(var f=0;f<a.length;f++){for(var v=10*f,b=a[f][0],k=Object(y.g)().domain([0,r]).range([0,g]),x=0,w=0;w<b.length;w++){var O=k(b[w].value);if(0!==O){var _=g-(x+O);t.addSVGInfo(i,v,_,10,O,b[w].color),d.beginFill(t.colorHexMap[b[w].color]),d.drawRect(v,_,10,O),x+=O,m>_&&(m=_)}}if(Math.abs(o)>0)for(var j=a[f][1],E=Object(y.g)().domain([-Math.abs(o),0]).range([p,0]),S=0,z=0;z<j.length;z++){var C=E(j[z].value),P=g+S;t.addSVGInfo(i,v,P,10,C,j[z].color),d.beginFill(t.colorHexMap[j[z].color]),d.drawRect(v,P,10,C),S+=C}}var T=n.generateTexture(d,e.libraries.PIXI.SCALE_MODES.NEAREST),M=new e.libraries.PIXI.Sprite(T);M.width=t._xScale(s+c)-t._xScale(s),M.x=t._xScale(s),i.sprite=M,i.lowestY=m,i.graphics.addChild(i.sprite)},drawTextSequence:function(e,t,i){i.textGraphics||(i.textGraphics=new e.libraries.PIXI.Graphics,i.graphics.addChild(i.textGraphics));var n=t.getTilePosAndDimensions(i.tileData.zoomLevel,i.tileData.tilePos,t.tilesetInfo.tile_size),a=n.tileX,r=n.tileWidth,o=t.dimensions[1],l=i.tabularData,s=Array.from(new Set(l.map((function(e){return e.__N__})))),c=Array.from(new Set(l.map((function(e){return e.__G__})))),d=t._xScale.copy(),u=(d(a+r)-d(a))/c.length,h=u-10,g=1;if(!(h<2)){if(o<10)g=0;else if(h<5&&h>=2){g=Object(y.g)().domain([2,5]).range([0,1]).clamp(!0)(u-10)}i.textGraphics.alpha=g,l.forEach((function(t){var n=t.__Q__*u,r=new e.libraries.PIXI.Text(t.__N__,{fontSize:"12px",fontFamily:"Arial",fill:"black",fontWeight:"bold"});r.width=10,r.height=10,r.letter=t.__N__;var o=d(a)+n+u/2-r.width/2,l=s.length/2-r.height/2;r.position.x=o,r.position.y=l,i.textGraphics.addChild(r)}))}}};function _(e){if(!(this instanceof _?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var t=e.utils.colorToHex,i=function(i){Object(m.a)(a,i);var n=Object(f.a)(a);function a(e,t){var i;return Object(u.a)(this,a),(i=n.call(this,e,t)).initTrack(),i}return Object(h.a)(a,[{key:"initTrack",value:function(){var e,t,i,n,a,r,o,l,s;this.isGeminiTrackInit||(this.maxAndMin={max:null,min:null},this.isStackedBarChart=(null===(e=this.options)||void 0===e||null===(t=e.spec)||void 0===t?void 0:t.color)&&!(null===(i=this.options)||void 0===i||null===(n=i.spec)||void 0===n?void 0:n.row)&&"bar"===(null===(a=this.options)||void 0===a||null===(r=a.spec)||void 0===r?void 0:r.mark),this.gmTrackSpec={original:this.options.spec,regular:this.options.spec,zoomOut:"alt-representation"===(null===(o=this.options.spec)||void 0===o||null===(l=o.zoomOutTechnique)||void 0===l?void 0:l.type)?w()(JSON.parse(JSON.stringify(this.options.spec)),null===(s=this.options.spec)||void 0===s?void 0:s.zoomOutTechnique.spec):this.options.spec},this.isGeminiTrackInit=!0)}},{key:"initTile",value:function(e){this.initTrack(),this.scale.minRawValue=this.minVisibleValue(),this.scale.maxRawValue=this.maxVisibleValue(),this.scale.minValue=this.scale.minRawValue,this.scale.maxValue=this.scale.maxRawValue,this.maxAndMin.min=Object(y.f)(e.tileData.dense),this.maxAndMin.max=Object(y.e)(e.tileData.dense),this.localColorToHexScale(),this.unFlatten(e),this.tabularizeTile(e),this.renderTile(e),this.rescaleTiles()}},{key:"renderTile",value:function(t){var i;t.mouseOverData=null,t.graphics.clear(),t.graphics.removeChildren(),this.pBorder.clear(),this.pBorder.removeChildren();var n,a,r,o,l,s,c,d,u,h,g,p,m=v();if(t.drawnAtScale=this._xScale.copy(),(null===t||void 0===t||null===(i=t.tileData)||void 0===i?void 0:i.zoomLevel)!==m)if("none"===(null===(n=this.options)||void 0===n||null===(a=n.spec)||void 0===a||null===(r=a.zoomOutTechnique)||void 0===r?void 0:r.type))O.drawZoomInstruction(e,this);else if("aggregate"===(null===(o=this.options)||void 0===o||null===(l=o.spec)||void 0===l||null===(s=l.zoomOutTechnique)||void 0===s?void 0:s.type))O.drawStackedBarChart(e,this,t);else if("alt-representation"===(null===(c=this.options)||void 0===c||null===(d=c.spec)||void 0===d||null===(u=d.zoomOutTechnique)||void 0===u?void 0:u.type)){var f,y,b,k,x,w,_,j;(null===(f=this.options)||void 0===f||null===(y=f.spec)||void 0===y||null===(b=y.zoomOutTechnique)||void 0===b||null===(k=b.spec)||void 0===k?void 0:k.mark)?O.drawLineCharts(this,t):(null===(x=this.options)||void 0===x||null===(w=x.spec)||void 0===w||null===(_=w.zoomOutTechnique)||void 0===_||null===(j=_.spec)||void 0===j?void 0:j.row)&&O.drawMultipleBarCharts(e,this,t)}else"auto"===(null===(h=this.options)||void 0===h||null===(g=h.spec)||void 0===g||null===(p=g.zoomOutTechnique)||void 0===p?void 0:p.type)&&O.drawStackedBarChart(e,this,t);else O.drawStackedBarChart(e,this,t)}},{key:"syncMaxAndMin",value:function(){var e=this;this.visibleAndFetchedTiles().map((function(t){t.minValue+t.maxValue>e.maxAndMin.min+e.maxAndMin.max&&(e.maxAndMin.min=t.minValue,e.maxAndMin.max=t.maxValue)}))}},{key:"rescaleTiles",value:function(){var e=this,t=this.visibleAndFetchedTiles();this.syncMaxAndMin(),t.map((function(t){var i=Object(y.g)().domain([0,e.maxAndMin.max+Math.abs(e.maxAndMin.min)]).range([0,e.dimensions[1]]),n=e.dimensions[1]-i(Math.abs(e.maxAndMin.min)),a=i(t.minValue+t.maxValue),r=t.sprite,o=n-i(t.maxValue);r&&(r.height=a,r.y=o)}))}},{key:"localColorToHexScale",value:function(){var e=this.options.colorScale,i={};e.forEach((function(e){i[e]=t(e)})),this.colorHexMap=i}},{key:"unFlatten",value:function(e){if(e.matrix)return e.matrix;var t=e.tileData.dense,i=this.simpleUnFlatten(e,t),n=b(i);return e.matrix=i,e.maxValue=n.max,e.minValue=n.min,this.syncMaxAndMin(),i}},{key:"tabularizeTile",value:function(e){if(!e.tabularData){for(var t=["A","T","G","C"],i=e.tileData.dense,n=Object(y.f)([e.tileData.shape[0],t.length]),a=e.tileData.shape[1],r=[],o=0;o<n;o++)for(var l=0;l<a;l++){var s;r.push((s={},Object(d.a)(s,"__N__",t[o]),Object(d.a)(s,"__Q__",i[a*o+l]),Object(d.a)(s,"__G__",l),s))}e.tabularData=r;var c=k(r,this.isStackedBarChart),u=c.min,h=c.max;e.maxValue=h,e.minValue=u,this.syncMaxAndMin()}}},{key:"simpleUnFlatten",value:function(e,t){for(var i=e.tileData.shape[0],n=e.tileData.shape[1],a=[],r=0;r<i;r++)for(var o=0;o<n;o++){var l=void 0;(l=void 0===a[o]?[]:a[o]).push(t[n*r+o]),a[o]=l}return a}},{key:"mapOriginalColors",value:function(e){for(var t=[],i=0;i<e.length;i++){for(var n=[],a=0;a<e[i].length;a++)n[a]={value:isNaN(e[i][a])?0:e[i][a],color:this.options.colorScale[a]};for(var r=[],o=[],l=0;l<n.length;l++)n[l].value>=0?r.push(n[l]):n[l].value<0&&o.push(n[l]);this.options.sortLargestOnTop?(r.sort((function(e,t){return e.color-t.color})),o.sort((function(e,t){return t.value-e.value}))):(r.sort((function(e,t){return t.value-e.value})),o.sort((function(e,t){return e.value-t.value}))),t.push([r,o])}return t}},{key:"setDimensions",value:function(e){var t=this;this.oldDimensions=this.dimensions,Object(g.a)(Object(p.a)(a.prototype),"setDimensions",this).call(this,e),this.visibleAndFetchedTiles().map((function(e){return t.initTile(e)}))}},{key:"rerender",value:function(e){Object(g.a)(Object(p.a)(a.prototype),"rerender",this).call(this,e),this.options=e;for(var t=this.visibleAndFetchedTiles(),i=0;i<t.length;i++)this.updateTile(t[i]);this.rescaleTiles(),this.draw()}},{key:"updateTile",value:function(){for(var e=this.visibleAndFetchedTiles(),t=0;t<e.length;t++){var i=e[t];this.unFlatten(i),this.tabularizeTile(i)}this.rescaleTiles()}},{key:"draw",value:function(){Object(g.a)(Object(p.a)(a.prototype),"draw",this).call(this)}},{key:"drawTile",value:function(){}},{key:"exportSVG",value:function(){}},{key:"getMouseOverHtml",value:function(){}}]),a}(e.tracks.BarTrack),n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return Object(c.a)(i,a)}_.config={type:"gemini-track",datatype:["multivec","epilogos"],local:!1,orientation:"1d-horizontal",thumbnail:(new DOMParser).parseFromString('<svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 5640 5420" preserveAspectRatio="xMidYMid meet"> <g id="layer101" fill="#000000" stroke="none"> <path d="M0 2710 l0 -2710 2820 0 2820 0 0 2710 0 2710 -2820 0 -2820 0 0 -2710z"/> </g> <g id="layer102" fill="#750075" stroke="none"> <path d="M200 4480 l0 -740 630 0 630 0 0 740 0 740 -630 0 -630 0 0 -740z"/> <path d="M1660 4420 l0 -800 570 0 570 0 0 800 0 800 -570 0 -570 0 0 -800z"/> <path d="M3000 3450 l0 -1770 570 0 570 0 0 1770 0 1770 -570 0 -570 0 0 -1770z"/> <path d="M4340 2710 l0 -2510 560 0 560 0 0 2510 0 2510 -560 0 -560 0 0 -2510z"/> <path d="M200 1870 l0 -1670 630 0 630 0 0 1670 0 1670 -630 0 -630 0 0 -1670z"/> <path d="M1660 1810 l0 -1610 570 0 570 0 0 1610 0 1610 -570 0 -570 0 0 -1610z"/> <path d="M3000 840 l0 -640 570 0 570 0 0 640 0 640 -570 0 -570 0 0 -640z"/> </g> <g id="layer103" fill="#ffff04" stroke="none"> <path d="M200 4480 l0 -740 630 0 630 0 0 740 0 740 -630 0 -630 0 0 -740z"/> <path d="M1660 4420 l0 -800 570 0 570 0 0 800 0 800 -570 0 -570 0 0 -800z"/> <path d="M3000 3450 l0 -1770 570 0 570 0 0 1770 0 1770 -570 0 -570 0 0 -1770z"/> </g> </svg>',"text/xml").documentElement,availableOptions:["colorScale","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","trackBorderWidth","trackBorderColor","trackType","scaledHeight","backgroundColor","barBorder","sortLargestOnTop"],defaultOptions:{labelPosition:"none",labelColor:"black",labelTextOpacity:.4,trackBorderWidth:0,trackBorderColor:"black",backgroundColor:"white",barBorder:!1,sortLargestOnTop:!0,colorScale:Object(y.h)(y.j)}};var j=_,E=i(401),S=i(405),z=i(406),C=i.n(z),P=(i(198),i(410));var T=function(e){var t=e.code,i=e.readOnly,r=Object(n.useRef)(null),o=Object(n.useState)(t),l=Object(s.a)(o,2),c=l[0],d=l[1];return Object(n.useEffect)((function(){d(t)}),[t]),a.a.createElement(a.a.Fragment,null,a.a.createElement(P.a,{handleWidth:!0,handleHeight:!0,onResize:function(e,t){var i;null===r||void 0===r||null===(i=r.current)||void 0===i||i.layout({width:e,height:t})}}),a.a.createElement(C.a,{language:"json",value:c,theme:"test",options:{autoClosingBrackets:"never",autoClosingQuotes:"never",cursorBlinking:"smooth",folding:!0,lineNumbersMinChars:4,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",lineNumbers:"off",renderLineHighlight:"line",renderIndentGuides:!0,readOnly:i},onChange:function(t,i){d(t),e.onChange&&e.onChange(t)},editorDidMount:function(e,t){r.current=e,e.focus()},editorWillMount:function(e){}}))},M=i(189),D=i.n(M),A=i(233),B=i(205),F=i.n(B),I=i(231),V=i.n(I),G=[{name:"gene-annotation",mark:{type:"compositeMark",name:"gene-annotation",requiredChannels:["x","xe","y","color","geneOrExon","exonId","exonVersion"],elements:[{description:"horizontal line",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:"line",color:{value:"black"},size:{value:3}},{description:"exon",select:[{channel:"geneOrExon",oneOf:["exon"]},{channel:"exonVersion",oneOf:["2"]}],mark:"rect",size:{value:25}},{description:"gene left",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:{bind:"y",domain:["-","+"],range:["triangle-l","rule"]},size:{value:25},xe:"none"},{description:"gene right",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:{bind:"y",domain:["-","+"],range:["rule","triangle-r"]},size:{value:25},x:{bind:"xe"},xe:"none"},{mark:"text",select:[{channel:"geneOrExon",oneOf:["gene"]}],opacity:{value:1},size:{value:18},style:{dy:-20}},{mark:"text",select:[{channel:"geneOrExon",oneOf:["exon"]},{channel:"exonVersion",oneOf:["2"]}],text:{bind:"exonId"},opacity:{value:1},size:{value:6},style:{dy:28}}]}},{name:"gene-annotation-simple",mark:{type:"compositeMark",name:"gene-annotation",requiredChannels:["x","xe","y","color","geneOrExon"],elements:[{description:"gene range rect",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:"rect",size:{value:25}},{description:"gene left",select:[{channel:"geneOrExon",oneOf:["gene"]},{channel:"y",oneOf:["-"]}],mark:"triangle-l",size:{value:25},xe:"none"},{description:"gene right",select:[{channel:"geneOrExon",oneOf:["gene"]},{channel:"y",oneOf:["+"]}],mark:"triangle-r",size:{value:25},x:{bind:"xe"},xe:"none"},{description:"gene range line",select:[{channel:"geneOrExon",oneOf:["gene"]}],mark:"line",color:{value:"gray"},size:{value:2},style:{dashed:"3, 3"}},{description:"gene name",mark:"text",select:[{channel:"geneOrExon",oneOf:["gene"]}],color:{value:"black"},opacity:{value:1},size:{value:18},style:{dy:-20}}]}},{name:"cytogenetic-band",mark:{type:"compositeMark",name:"cytogenetic-band",requiredChannels:["x","xe","y","color","text","stain"],elements:[{description:"symbols",select:[{channel:"stain",oneOf:["gneg","gpos","gvar"]}],mark:"rect",size:{value:25},style:{stroke:"black",strokeWidth:1}},{description:"acen",select:[{channel:"text",oneOf:["11","11.1"]}],mark:{bind:"text",domain:["11","11.1"],range:["triangle-l","triangle-r"]},color:{value:"#B40101"},size:{value:25},style:{stroke:"black",strokeWidth:1}},{mark:"text",select:[{channel:"color",oneOf:["100","75","50"]}],color:{value:"black"},size:{value:10},style:{dy:-20}}]}}],W=["gene-annotation-simple","gene-annotation","cytogenetic-band"];function H(e){for(var t=0;t<e.tracks.length;t++){var i=e.tracks[t];$(i)&&N(i.mark)&&function(){var e,t=i.mark.type;W.includes(t)&&(i.mark=null===(e=G.find((function(e){return e.name===t})))||void 0===e?void 0:e.mark)}()}return e}function L(e){return"object"===typeof e}function $(e){return e!=={}}function N(e){return"object"===typeof e}function R(e){return"object"===typeof e&&"compositeMark"===e.type}function q(e){return"object"===typeof e.mark&&R(e.mark)&&"compositeMark"!==e.mark.type||L(e.data)&&!(!(t=e.data.url).includes("tileset_info/?d=")||!t.includes("https:")&&!t.includes("http:"));var t}function X(e){return null!==e&&"object"===typeof e&&"value"in e}function Q(e){return null!==e&&"object"===typeof e&&"bind"in e}function U(e){return"object"===typeof e&&!("value"in e)}var J=i(409),Y="http://localhost:8001/api/v1/tileset_info/?d=XX4dPR0dSCGzD2n-xtlhbA",Z=[{name:"Gene Annotation Plot (Simple)",spec:{tracks:[{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/Homo_sapiens.GRCh38.92.glyph.csv",type:"csv"},mark:{server:"gemini.v1",type:"gene-annotation-simple"},x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},y:{field:"strand",type:"nominal"},text:{field:"gene_name",type:"nominal"},geneOrExon:{field:"feature",type:"nominal"},color:{value:"#D1D28D"},opacity:{value:.7}}]},glyphWidth:300,glyphHeight:150},{name:"Gene Annotation Plot",spec:{tracks:[{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/Homo_sapiens.GRCh38.92.glyph.csv",type:"csv"},mark:{server:"gemini.v1",type:"gene-annotation"},x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},y:{field:"strand",type:"nominal"},text:{field:"gene_name",type:"nominal"},color:{field:"strand",type:"nominal"},exonVersion:{field:"exon_version",type:"nominal"},geneOrExon:{field:"feature",type:"nominal"},exonId:{field:"exon_id",type:"nominal"},opacity:{value:.9}}]},glyphWidth:600,glyphHeight:150},{name:"Cytogenetic Band",spec:{tracks:[{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/chr1_cytogenetic_band.glyph.csv",type:"csv"},mark:{server:"gemini.v1",type:"cytogenetic-band"},x:{field:"Basepair_start",type:"genomic"},xe:{field:"Basepair_stop",type:"genomic"},y:{field:"Chr.",type:"nominal"},text:{field:"Band",type:"nominal"},stain:{field:"Stain",type:"nominal"},color:{field:"Density",type:"nominal",domain:["","25","50","75","100"],range:["white","#D9D9D9","#979797","#636363","black"]}}]},glyphWidth:900,glyphHeight:150},{name:"Six Different Between-Links",spec:{tracks:[{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x:{field:"from",type:"nominal"},y:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x1:{field:"from",type:"nominal"},y:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x1:{field:"from",type:"nominal"},y1:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x:{field:"from",type:"nominal"},y1:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x:{field:"from",type:"nominal"},x1:{field:"to",type:"nominal"},width:50,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",y:{field:"from",type:"nominal"},y1:{field:"to",type:"nominal"},width:50,height:50}]},glyphWidth:0,glyphHeight:0},{name:"Between-Links (Combo)",spec:{references:["http://genocat.tools/tools/combo.html","http://genocat.tools/tools/gbrowse_syn.html","http://genocat.tools/tools/ggbio.html","http://genocat.tools/tools/give.html","http://genocat.tools/tools/variant_view.html"],tracks:[{data:{url:"dummy",type:"csv"},mark:"dummy",width:800,height:50},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",x1:{field:"from",type:"nominal"},x:{field:"to",type:"nominal"},width:800,height:50},{data:{url:"dummy",type:"csv"},mark:"dummy",width:800,height:50}]},glyphWidth:0,glyphHeight:0},{name:"Between-Links (Combo, Horizontal)",spec:{layout:{type:"linear",direction:"horizontal"},tracks:[{data:{url:"dummy",type:"csv"},mark:"dummy",width:60,height:500},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/potint-to-point-relation.csv",type:"csv"},mark:"link-between",y:{field:"from",type:"nominal"},y1:{field:"to",type:"nominal"},width:60,height:500},{data:{url:"dummy",type:"csv"},mark:"dummy",width:60,height:500}]},glyphWidth:0,glyphHeight:0},{name:"Stacked Multiple Tracks",spec:{layout:{type:"linear",direction:"horizontal",wrap:2},tracks:[{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:350,height:30}]},glyphWidth:0,glyphHeight:0},{name:"Stacked Multiple Tracks (Circular)",spec:{layout:{type:"circular",direction:"horizontal",wrap:2},tracks:[{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30,style:{background:"#FAF9F7"}},{data:{url:"dummy",type:"csv"},mark:"dummy",width:500,height:30}]},glyphWidth:0,glyphHeight:0},{name:"Between-Bands (HiGlass Tracks)",spec:{references:["http://genocat.tools/tools/combo.html","http://genocat.tools/tools/gbrowse_syn.html","http://genocat.tools/tools/ggbio.html","http://genocat.tools/tools/give.html","http://genocat.tools/tools/variant_view.html"],tracks:[{data:{url:"https://resgen.io/api/v1/tileset_info/?d=a-iBpdh3Q_uO2FLCWKpOOw",type:"tileset"},mark:{type:"1d-heatmap-higlass",server:"gemini-v1"},x:{type:"genomic",domain:{chromosome:"2"}},width:800,height:60},{data:{url:"https://resgen.io/api/v1/tileset_info/?d=a-iBpdh3Q_uO2FLCWKpOOw",type:"tileset"},mark:{type:"line-higlass",server:"gemini-v1"},x:{type:"genomic",domain:{chromosome:"2"}},width:800,height:90},{data:{url:"https://higlass.io/api/v1/tileset_info/?d=OHJakQICQD6gTD7skx4EWA",type:"tileset"},mark:{type:"gene-annotation-higlass",server:"gemini-v1"},x:{type:"genomic",axis:!0,domain:{chromosome:"2"}},width:800,height:140},{data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/range-to-range-relation.csv",type:"csv"},mark:"link-between",x1:{field:"from"},x1e:{field:"from1"},x:{field:"to"},xe:{field:"to1"},width:800,height:260,stroke:{value:"none"}},{data:{url:"https://higlass.io/api/v1/tileset_info/?d=OHJakQICQD6gTD7skx4EWA",type:"tileset"},mark:{type:"gene-annotation-higlass",server:"gemini-v1"},x:{type:"genomic",domain:{chromosome:"3"}},x1:{axis:!0},width:800,height:140},{data:{url:"https://resgen.io/api/v1/tileset_info/?d=a-iBpdh3Q_uO2FLCWKpOOw",type:"tileset"},mark:{type:"bar-higlass",server:"gemini-v1"},x:{type:"genomic",domain:{chromosome:"4"}},width:800,height:80},{data:{url:"https://resgen.io/api/v1/tileset_info/?d=a-iBpdh3Q_uO2FLCWKpOOw",type:"tileset"},mark:{type:"point-higlass",server:"gemini-v1"},x:{type:"genomic"},width:800,height:80}]},glyphWidth:0,glyphHeight:0},{name:"HiGlass Gemini Track (zoom out example 1)",spec:{tracks:[{data:{url:Y,type:"tileset"},zoomOutTechnique:{type:"auto"},mark:"bar",x:{field:"__G__",type:"genomic",domain:{chromosome:"1",interval:[3e6,3000500]}},x1:{axis:!0},y:{field:"__Q__",type:"quantitative"},color:{field:"__N__",type:"nominal",domain:["A","T","G","C","N","other"],range:["#007FFF","#e8e500","#008000","#FF0038","#800080","#DCDCDC"]},width:1e3,height:180}]},glyphWidth:0,glyphHeight:0},{name:"HiGlass Gemini Track (zoom out example 2)",spec:{tracks:[{data:{url:Y,type:"tileset"},zoomOutTechnique:{type:"alt-representation",spec:{row:{field:"__N__",type:"nominal"}}},mark:"bar",x:{field:"__G__",type:"genomic",domain:{chromosome:"1",interval:[3e6,3000500]}},x1:{axis:!0},y:{field:"__Q__",type:"quantitative"},color:{field:"__N__",type:"nominal",domain:["A","T","G","C","N","other"],range:["#007FFF","#e8e500","#008000","#FF0038","#800080","#DCDCDC"]},width:1e3,height:180}]},glyphWidth:0,glyphHeight:0},{name:"HiGlass Gemini Track (zoom out example 3)",spec:{tracks:[{data:{url:Y,type:"tileset"},zoomOutTechnique:{type:"alt-representation",spec:{mark:"line"}},mark:"bar",x:{field:"__G__",type:"genomic",domain:{chromosome:"1",interval:[3e6,3000500]}},x1:{axis:!0},y:{field:"__Q__",type:"quantitative"},color:{field:"__N__",type:"nominal",domain:["A","T","G","C","N","other"],range:["#007FFF","#e8e500","#008000","#FF0038","#800080","#DCDCDC"]},width:1e3,height:180}]},glyphWidth:0,glyphHeight:0}];var K=i(187);var ee=function(){function e(t){Object(u.a)(this,e),this.track=void 0,this.channelToField=void 0,this.domains=void 0,this.scales=void 0,this.ranges=void 0,this.track=t,this.domains={},this.channelToField={},this.scales={},this.ranges={},R(this.track.mark)&&(this.track.mark.elements=function(e){var t=[];return e.forEach((function(e){if("object"===typeof e.mark)for(var i=e.mark.bind,n=0;n<e.mark.domain.length;n++){var a=e.mark.domain[n],r=e.mark.range[n],o=e.select?e.select:[];t.push(Object(l.a)(Object(l.a)({},e),{},{mark:r,select:[].concat(Object(K.a)(o),[{channel:i,oneOf:[a]}])}))}else t.push(e)})),t}(this.track.mark.elements)),this.setDomains()}return Object(h.a)(e,[{key:"getTrack",value:function(){return this.track}},{key:"getElements",value:function(){return R(this.track.mark)?this.track.mark.elements:[]}},{key:"getFieldByChannel",value:function(e){return this.channelToField[e]}},{key:"setDomains",value:function(){var e=this,t=this.track.data;R(this.track.mark)&&(this.track.mark.requiredChannels.forEach((function(i){var n,a=e.track[i];if(U(a)){var r=a.field;if(!r)return;e.channelToField[i]=r;var o="xe"===i?"x":"ye"===i?"y":i;e.domains[o]||(e.domains[o]=[]),e.domains[o]=[].concat(Object(K.a)(e.domains[o]),Object(K.a)(a.domain&&(n=a.domain,Array.isArray(n))?a.domain:t.map((function(e){return e[r]}))))}})),Object.keys(this.domains).forEach((function(t){var i=e.track[t];if(U(i)){var n=i.type;e.domains[t]="nominal"===n?y.m(e.domains[t]).values():y.c(e.domains[t].map((function(e){return+e})))}})))}},{key:"setRanges",value:function(e){var t=this;Object.keys(this.domains).forEach((function(i){var n=t.track[i];U(n)&&("x"===i?t.ranges.x=[e.x,e.x+e.width]:"y"===i?t.ranges.y=[e.y,e.y+e.height]:"color"===i&&(t.ranges.color=n.range?n.range:y.k))}))}},{key:"setScales",value:function(e){var t=this;this.setRanges(e),Object.keys(this.domains).forEach((function(e){var i=t.track[e];if(U(i)){var n=i.type;t.ranges[e]&&(t.scales[e]="color"===e&&"nominal"===n?y.h().domain(t.domains[e]).range(t.ranges[e]):"color"===e&&"quantitative"===n?y.i(y.d).domain(t.domains[e]):"nominal"===n?y.h().domain(t.domains[e]).range(t.ranges[e]):y.g().domain(t.domains[e]).range(t.ranges[e]))}}))}},{key:"getEncoding",value:function(e,t,i,n){var a="xe"===t?"x":"ye"===t?"y":t;if(X(e[t]))switch(t){case"size":case"opacity":case"color":case"text":return e[t].value}else if(X(this.track[t]))switch(t){case"size":case"opacity":case"color":case"text":return this.track[t].value}else{if(this.scales[a]){var r=Q(e[t])?this.getFieldByChannel(e[t].bind):this.getFieldByChannel(t);return this.scales[a](i[r])}if("text"!==t){if("w"===t){if(this.scales.x&&U(this.track.x)&&U(this.track.xe)&&"none"!==e.x&&"none"!==e.xe){var o=Math.abs(i[this.getFieldByChannel("xe")]-i[this.getFieldByChannel("x")]);return this.scales.x(o)}return this.getEncoding(e,"size",i)}return{opacity:1,size:10,color:"black",text:""}[t]}var l=Q(e.text)?this.getFieldByChannel(e.text.bind):U(this.track.text)?this.track.text.field:void 0;if(l)return i[l]}}},{key:"getScale",value:function(e){return this.scales[e]}}]),e}();function te(e,t,i,n,a){var r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];y.l(e).attr("width",t).attr("height",i);var o=y.l(e).append("g");o.append("rect").attr("width",t).attr("height",i).attr("stroke","lightgray").attr("fill","white"),r&&(o.append("line").attr("x1",0).attr("x2",t).attr("y1",a).attr("y2",a).attr("class","preview-guideline"),o.append("line").attr("x1",0).attr("x2",t).attr("y1",i-a).attr("y2",i-a).attr("class","preview-guideline"),o.append("line").attr("x1",n).attr("x2",n).attr("y1",0).attr("y2",i).attr("class","preview-guideline"),o.append("line").attr("x1",t-n).attr("x2",t-n).attr("y1",0).attr("y2",i).attr("class","preview-guideline"),o.append("line").attr("x1",0).attr("x2",t).attr("y1",i/2).attr("y2",i/2).attr("class","preview-guideline"),o.append("line").attr("x1",t/2).attr("x2",t/2).attr("y1",0).attr("y2",i).attr("class","preview-guideline"))}function ie(e,t,i,n){if(e&&t){y.l(e).selectAll("*").remove();var a=i,r=n;te(e,a,r,60,30),function(e,t,i){var n=new ee(t);n.setScales(Object(l.a)(Object(l.a)({},i),{},{y:i.y+i.height/2}));var a=t.data;a?R(t.mark)?n.getElements().forEach((function(t){var i=t.select,r=t.mark,o=[];null===i||void 0===i||i.forEach((function(e){var t=e.channel,i=e.oneOf;n.getFieldByChannel(t)&&o.push({field:n.getFieldByChannel(t),oneOf:i})}));var l,s,c=function(e,t){var i=e.slice();return t.forEach((function(e){i=i.filter((function(t){return-1!==e.oneOf.indexOf(t[e.field])}))})),i}(a,o);if("line"===r)e.selectAll().data(c).enter().append("line").attr("x1",(function(e){return n.getEncoding(t,"x",e)})).attr("x2",(function(e){return n.getEncoding(t,"xe",e)})).attr("y1",(function(e){return n.getEncoding(t,"y",e)})).attr("y2",(function(e){return n.getEncoding(t,"y",e)})).attr("stroke",(function(e){return n.getEncoding(t,"color",e)})).attr("stroke-width",(function(e){return n.getEncoding(t,"size",e)})).attr("opacity",(function(e){return n.getEncoding(t,"opacity",e)})).style("stroke-dasharray",null!==(l=null===(s=t.style)||void 0===s?void 0:s.dashed)&&void 0!==l?l:"");else if("point"===r)e.selectAll("point").data(c).enter().append("circle").attr("fill",(function(e){return n.getEncoding(t,"color",e)})).attr("cx",(function(e){return n.getEncoding(t,"x",e)})).attr("cy",(function(e){return n.getEncoding(t,"x",e)})).attr("r",15).attr("opacity",(function(e){return n.getEncoding(t,"opacity",e)}));else if("rect"===r){var d,u,h,g;e.selectAll().data(c).enter().append("rect").attr("x",(function(e){return n.getEncoding(t,"x",e)})).attr("y",(function(e){return n.getEncoding(t,"y",e)-n.getEncoding(t,"size",e)/2})).attr("width",(function(e){return n.getEncoding(t,"xe",e)-n.getEncoding(t,"x",e)})).attr("height",(function(e){return n.getEncoding(t,"size",e)})).attr("fill",(function(e){return n.getEncoding(t,"color",e)})).attr("opacity",(function(e){return n.getEncoding(t,"opacity",e)})).attr("stroke",null!==(d=null===(u=t.style)||void 0===u?void 0:u.stroke)&&void 0!==d?d:"").attr("stroke-width",null!==(h=null===(g=t.style)||void 0===g?void 0:g.strokeWidth)&&void 0!==h?h:"")}else if("text"===r)e.selectAll().data(c).enter().append("text").text((function(e){return n.getEncoding(t,"text",e)})).attr("x",(function(e){return(n.getEncoding(t,"x",e)+n.getEncoding(t,"xe",e))/2})).attr("y",(function(e){var i;return n.getEncoding(t,"y",e)+(null===(i=t.style)||void 0===i?void 0:i.dy)})).attr("fill",(function(e){return n.getEncoding(t,"color",e)})).attr("font-size",(function(e){return n.getEncoding(t,"size",e)})).attr("alignment-baseline","top").attr("text-anchor","middle").attr("opacity",(function(e){return n.getEncoding(t,"opacity",e)}));else if("rule"===r)e.selectAll("rule").data(c).enter().append("line").attr("x1",(function(e){return n.getEncoding(t,"x",e)})).attr("x2",(function(e){return n.getEncoding(t,"x",e)})).attr("y1",(function(e){return n.getEncoding(t,"x",e)-n.getEncoding(t,"size",e)/2})).attr("y2",(function(e){return n.getEncoding(t,"x",e)-n.getEncoding(t,"size",e)/2})).attr("stroke",(function(e){return n.getEncoding(t,"color",e)})).attr("stroke-width",3).attr("opacity",(function(e){return n.getEncoding(t,"opacity",e)}));else if("triangle-r"===r){var p,m,f,y;e.selectAll("trangle-r").data(c).enter().append("path").attr("d",(function(e){var i=n.getEncoding(t,"size",e),a=n.getEncoding(t,"w",e),r=n.getEncoding(t,"x",e),o=n.getEncoding(t,"y",e);return"M".concat(r+a," ").concat(o)+"L".concat(r," ").concat(o+i/2)+"L".concat(r," ").concat(o-i/2," Z")})).attr("fill",(function(e){return n.getEncoding(t,"color",e)})).attr("opacity",(function(e){return n.getEncoding(t,"opacity",e)})).attr("stroke",null!==(p=null===(m=t.style)||void 0===m?void 0:m.stroke)&&void 0!==p?p:"").attr("stroke-width",null!==(f=null===(y=t.style)||void 0===y?void 0:y.strokeWidth)&&void 0!==f?f:"")}else if("triangle-l"===r){var v,b,k,x;e.selectAll("trangle-l").data(c).enter().append("path").attr("d",(function(e){var i=n.getEncoding(t,"size",e),a=n.getEncoding(t,"w",e),r=n.getEncoding(t,"x",e),o=n.getEncoding(t,"y",e);return"M".concat(r," ").concat(o)+"L".concat(r+a," ").concat(o+i/2)+"L".concat(r+a," ").concat(o-i/2," Z")})).attr("fill",(function(e){return n.getEncoding(t,"color",e)})).attr("opacity",(function(e){return n.getEncoding(t,"opacity",e)})).attr("stroke",null!==(v=null===(b=t.style)||void 0===b?void 0:b.stroke)&&void 0!==v?v:"").attr("stroke-width",null!==(k=null===(x=t.style)||void 0===x?void 0:x.strokeWidth)&&void 0!==k?k:"")}})):console.warn("Glyph is not defined."):console.warn("No array of a JSON object suggested.")}(y.l(e).append("g").attr("width",a-120).attr("height",r-60).attr("transform","translate(".concat(60,",").concat(30,")")),t,{x:0,width:a-120,y:0,height:r-60})}}var ne=i(269),ae={chr1:249250621,chr2:243199373,chr3:198022430,chr4:191154276,chr5:180915260,chr6:171115067,chr7:159138663,chr8:146364022,chr9:141213431,chr10:135534747,chr11:135006516,chr12:133851895,chr13:115169878,chr14:107349540,chr15:102531392,chr16:90354753,chr17:81195210,chr18:78077248,chr19:59128983,chr20:63025520,chr21:48129895,chr22:51304566,chrX:155270560,chrY:59373566,chrM:16571},re={};Object.keys(ae).reduce((function(e,t){return re[t]=[e,e+ae[t]],e+ae[t]}),0);var oe=Object.values(ae).reduce((function(e,t){return e+t}),0),le=function(){function e(){Object(u.a)(this,e),this.hg=void 0,this.hg={},this.setEditable(!1),this.setChromInfoPath("//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv"),this.hg.trackSourceServers=[],this.hg.views=[{uid:V.a.v1(),genomePositionSearchBoxVisible:!1,layout:{w:12,h:12,x:0,y:0},tracks:{top:[],left:[],center:[],right:[],bottom:[],gallery:[],whole:[]},initialXDomain:[0,oe],initialYDomain:[0,oe]}]}return Object(h.a)(e,[{key:"spec",value:function(){return this.hg}},{key:"getNumericDomain",value:function(e){if(function(e){return"chromosome"in e&&!("interval"in e)}(e))return re["chr".concat(e.chromosome)];if(function(e){return!("chromosome"in e)&&"interval"in e}(e))return e.interval;if(function(e){return"chromosome"in e&&"interval"in e}(e)){var t=re["chr".concat(e.chromosome)][0],i=Object(s.a)(e.interval,2);return[t+i[0],t+i[1]]}}},{key:"setDomain",value:function(e,t){var i,n;e&&(null===(i=this.hg.views)||void 0===i?void 0:i[0])&&(this.hg.views[0].initialXDomain=this.getNumericDomain(e)),t&&(null===(n=this.hg.views)||void 0===n?void 0:n[0])&&(this.hg.views[0].initialYDomain=this.getNumericDomain(t))}},{key:"setEditable",value:function(e){return this.hg.editable=e,this}},{key:"setChromInfoPath",value:function(e){return this.hg.chromInfoPath=e,this}},{key:"addTrackSourceServers",value:function(e){var t,i;return e&&-1===(null===(t=this.hg.trackSourceServers)||void 0===t?void 0:t.indexOf(e))&&(null===(i=this.hg.trackSourceServers)||void 0===i||i.push(e)),this}},{key:"setMainTrack",value:function(e){return this.hg.views?(this.hg.views[0].tracks.center=[e],this):this}},{key:"setAxisTrack",value:function(e){var t;if(!this.hg.views)return this;var i="left"===e||"right"===e?"vertical":"horizontal",n="vertical"===i?"width":"height";return this.hg.views[0].tracks[e]=[(t={uid:V.a.v1(),type:i+"-chromosome-labels"},Object(d.a)(t,n,30),Object(d.a)(t,"chromInfoPath",this.hg.chromInfoPath),t)],this}},{key:"validateSpec",value:function(){var e=new F.a({extendRefs:!0}).compile(ne),t=e(this.spec());return e.errors&&console.warn(JSON.stringify(e.errors,null,2)),t}}]),e}(),se=["rgba(68,1,84,1)","rgba(68,2,85,1)","rgba(69,3,87,1)","rgba(69,5,88,1)","rgba(69,6,90,1)","rgba(70,8,91,1)","rgba(70,9,93,1)","rgba(70,11,94,1)","rgba(70,12,96,1)","rgba(71,14,97,1)","rgba(71,15,98,1)","rgba(71,17,100,1)","rgba(71,18,101,1)","rgba(71,20,102,1)","rgba(72,21,104,1)","rgba(72,22,105,1)","rgba(72,24,106,1)","rgba(72,25,108,1)","rgba(72,26,109,1)","rgba(72,28,110,1)","rgba(72,29,111,1)","rgba(72,30,112,1)","rgba(72,32,113,1)","rgba(72,33,115,1)","rgba(72,34,116,1)","rgba(72,36,117,1)","rgba(72,37,118,1)","rgba(72,38,119,1)","rgba(72,39,120,1)","rgba(71,41,121,1)","rgba(71,42,121,1)","rgba(71,43,122,1)","rgba(71,44,123,1)","rgba(71,46,124,1)","rgba(70,47,125,1)","rgba(70,48,126,1)","rgba(70,49,126,1)","rgba(70,51,127,1)","rgba(69,52,128,1)","rgba(69,53,129,1)","rgba(69,54,129,1)","rgba(68,56,130,1)","rgba(68,57,131,1)","rgba(68,58,131,1)","rgba(67,59,132,1)","rgba(67,60,132,1)","rgba(67,62,133,1)","rgba(66,63,133,1)","rgba(66,64,134,1)","rgba(65,65,134,1)","rgba(65,66,135,1)","rgba(65,67,135,1)","rgba(64,69,136,1)","rgba(64,70,136,1)","rgba(63,71,136,1)","rgba(63,72,137,1)","rgba(62,73,137,1)","rgba(62,74,137,1)","rgba(61,75,138,1)","rgba(61,77,138,1)","rgba(60,78,138,1)","rgba(60,79,138,1)","rgba(59,80,139,1)","rgba(59,81,139,1)","rgba(58,82,139,1)","rgba(58,83,139,1)","rgba(57,84,140,1)","rgba(57,85,140,1)","rgba(56,86,140,1)","rgba(56,87,140,1)","rgba(55,88,140,1)","rgba(55,89,140,1)","rgba(54,91,141,1)","rgba(54,92,141,1)","rgba(53,93,141,1)","rgba(53,94,141,1)","rgba(52,95,141,1)","rgba(52,96,141,1)","rgba(51,97,141,1)","rgba(51,98,141,1)","rgba(51,99,141,1)","rgba(50,100,142,1)","rgba(50,101,142,1)","rgba(49,102,142,1)","rgba(49,103,142,1)","rgba(48,104,142,1)","rgba(48,105,142,1)","rgba(47,106,142,1)","rgba(47,107,142,1)","rgba(47,108,142,1)","rgba(46,109,142,1)","rgba(46,110,142,1)","rgba(45,111,142,1)","rgba(45,112,142,1)","rgba(45,112,142,1)","rgba(44,113,142,1)","rgba(44,114,142,1)","rgba(43,115,142,1)","rgba(43,116,142,1)","rgba(43,117,142,1)","rgba(42,118,142,1)","rgba(42,119,142,1)","rgba(41,120,142,1)","rgba(41,121,142,1)","rgba(41,122,142,1)","rgba(40,123,142,1)","rgba(40,124,142,1)","rgba(40,125,142,1)","rgba(39,126,142,1)","rgba(39,127,142,1)","rgba(38,128,142,1)","rgba(38,129,142,1)","rgba(38,130,142,1)","rgba(37,131,142,1)","rgba(37,131,142,1)","rgba(37,132,142,1)","rgba(36,133,142,1)","rgba(36,134,142,1)","rgba(35,135,142,1)","rgba(35,136,142,1)","rgba(35,137,142,1)","rgba(34,138,141,1)","rgba(34,139,141,1)","rgba(34,140,141,1)","rgba(33,141,141,1)","rgba(33,142,141,1)","rgba(33,143,141,1)","rgba(32,144,141,1)","rgba(32,145,140,1)","rgba(32,146,140,1)","rgba(32,147,140,1)","rgba(31,147,140,1)","rgba(31,148,140,1)","rgba(31,149,139,1)","rgba(31,150,139,1)","rgba(31,151,139,1)","rgba(30,152,139,1)","rgba(30,153,138,1)","rgba(30,154,138,1)","rgba(30,155,138,1)","rgba(30,156,137,1)","rgba(30,157,137,1)","rgba(30,158,137,1)","rgba(30,159,136,1)","rgba(30,160,136,1)","rgba(31,161,136,1)","rgba(31,162,135,1)","rgba(31,163,135,1)","rgba(31,163,134,1)","rgba(32,164,134,1)","rgba(32,165,134,1)","rgba(33,166,133,1)","rgba(33,167,133,1)","rgba(34,168,132,1)","rgba(35,169,131,1)","rgba(35,170,131,1)","rgba(36,171,130,1)","rgba(37,172,130,1)","rgba(38,173,129,1)","rgba(39,174,129,1)","rgba(40,175,128,1)","rgba(41,175,127,1)","rgba(42,176,127,1)","rgba(43,177,126,1)","rgba(44,178,125,1)","rgba(46,179,124,1)","rgba(47,180,124,1)","rgba(48,181,123,1)","rgba(50,182,122,1)","rgba(51,183,121,1)","rgba(53,183,121,1)","rgba(54,184,120,1)","rgba(56,185,119,1)","rgba(57,186,118,1)","rgba(59,187,117,1)","rgba(61,188,116,1)","rgba(62,189,115,1)","rgba(64,190,114,1)","rgba(66,190,113,1)","rgba(68,191,112,1)","rgba(70,192,111,1)","rgba(72,193,110,1)","rgba(73,194,109,1)","rgba(75,194,108,1)","rgba(77,195,107,1)","rgba(79,196,106,1)","rgba(81,197,105,1)","rgba(83,198,104,1)","rgba(85,198,102,1)","rgba(88,199,101,1)","rgba(90,200,100,1)","rgba(92,201,99,1)","rgba(94,201,98,1)","rgba(96,202,96,1)","rgba(98,203,95,1)","rgba(101,204,94,1)","rgba(103,204,92,1)","rgba(105,205,91,1)","rgba(108,206,90,1)","rgba(110,206,88,1)","rgba(112,207,87,1)","rgba(115,208,85,1)","rgba(117,208,84,1)","rgba(119,209,82,1)","rgba(122,210,81,1)","rgba(124,210,79,1)","rgba(127,211,78,1)","rgba(129,212,76,1)","rgba(132,212,75,1)","rgba(134,213,73,1)","rgba(137,213,72,1)","rgba(139,214,70,1)","rgba(142,215,68,1)","rgba(144,215,67,1)","rgba(147,216,65,1)","rgba(149,216,63,1)","rgba(152,217,62,1)","rgba(155,217,60,1)","rgba(157,218,58,1)","rgba(160,218,57,1)","rgba(163,219,55,1)","rgba(165,219,53,1)","rgba(168,220,51,1)","rgba(171,220,50,1)","rgba(173,221,48,1)","rgba(176,221,46,1)","rgba(179,221,45,1)","rgba(181,222,43,1)","rgba(184,222,41,1)","rgba(187,223,39,1)","rgba(189,223,38,1)","rgba(192,223,36,1)","rgba(195,224,35,1)","rgba(197,224,33,1)","rgba(200,225,32,1)","rgba(203,225,30,1)","rgba(205,225,29,1)","rgba(208,226,28,1)","rgba(211,226,27,1)","rgba(213,226,26,1)","rgba(216,227,25,1)","rgba(219,227,24,1)","rgba(221,227,24,1)","rgba(224,228,24,1)","rgba(226,228,24,1)","rgba(229,228,24,1)","rgba(232,229,25,1)","rgba(234,229,25,1)","rgba(237,229,26,1)","rgba(239,230,27,1)","rgba(242,230,28,1)","rgba(244,230,30,1)","rgba(247,230,31,1)","rgba(249,231,33,1)","rgba(251,231,35,1)","rgba(254,231,36,1)"];function ce(e,t){var i,n=new le;if(q(e)&&L(e.data)){var a,r=(i=e.data.url).includes("tileset_info/?d=")&&(i.includes("https:")||i.includes("http:"))?{server:i.split("tileset_info/?d=")[0],tilesetUid:i.split("tileset_info/?d=")[1]}:(console.warn("Data url format is incorrect:"+i),{server:void 0,tilesetUid:void 0}),o=r.server,s=r.tilesetUid,c=U(e.x)&&"genomic"===e.x.type,d=U(e.y)&&"genomic"===e.y.type,u=c&&U(e.x)?e.x.domain:void 0,h=d&&U(e.y)?e.y.domain:void 0,g=U(e.color)?e.color.range:void 0,p=c&&d?"both":c?"horizontal":"vertical",m="object"!==typeof e.mark?e.mark:N(e.mark)?e.mark.type:"unknown";a=e.zoomOutTechnique;n.setDomain(u,h);var f={"gemini-track-higlass":"gemini-track",point:"gemini-track",bar:"gemini-track",line:"gemini-track",rect:"gemini-track","gene-annotation-higlass":"".concat(p,"-gene-annotations"),"point-higlass":"".concat(p,"-point"),"bar-higlass":"".concat(p,"-bar"),"line-higlass":"".concat(p,"-line"),"1d-heatmap-higlass":"".concat(p,"-1d-heatmap")},y={"point-higlass":{pointColor:"#0072B2",labelPosition:"hidden",axisPositionHorizontal:"left"},"bar-higlass":{barFillColor:"#0072B2",labelPosition:"hidden",axisPositionHorizontal:"left"},"line-higlass":{lineStrokeColor:"#0072B2",labelPosition:"hidden",axisPositionHorizontal:"left"},"1d-heatmap-higlass":{colorRange:se,labelPosition:"hidden"}},v=f[m];if(!v)return{};n.setMainTrack({type:v,server:o,tilesetUid:s,width:t.width,height:t.height,options:Object(l.a)(Object(l.a)({},y[m]),{},{colorScale:g,spec:Object(l.a)(Object(l.a)({},e),{},{data:void 0})})}).addTrackSourceServers(o);var b={x:"bottom",x1:"top",y:"left",y1:"right"};return Object.keys(b).forEach((function(t){var i=e[t];U(i)&&i.axis&&n.setAxisTrack(b[t])})),n.validateSpec(),console.log("HiGlass viewConfig:",n.spec()),n.spec()}return{}}var de=function(){function e(t){Object(u.a)(this,e),this.validity=void 0,this.validity={msg:"No message",isValid:t||!1}}return Object(h.a)(e,[{key:"getValidity",value:function(){return this.validity}},{key:"isValid",value:function(){return this.validity.isValid}},{key:"setMsg",value:function(e){return this.validity.msg=e,this}},{key:"setIsValid",value:function(e){return this.validity.isValid=e,this}},{key:"setValidity",value:function(e){return this.setIsValid(e.isValid),this.setMsg(e.msg),this}},{key:"printValidity",value:function(){this.getValidity().isValid?console.log(this.validity.msg):console.warn(this.validity.msg)}}]),e}();var ue={fill:"lightgray",stroke:"gray",strokeWidth:1,opacity:.7},he={color:"fill",stroke:"stroke",strokeWidth:"strokeWidth",opacity:"opacity"},ge=function(){function e(t){var i=this;Object(u.a)(this,e),this.style=void 0,this.style=Object(l.a)({},ue),Object.keys(he).forEach((function(e){var n=t[e];X(n)&&(i.style[he[e]]=n.value)}))}return Object(h.a)(e,[{key:"getStyle",value:function(){return this.style}}]),e}();function pe(e){var t=U(e.x)?e.x.field:void 0,i=U(e.x1)?e.x1.field:void 0,n=U(e.y)?e.y.field:void 0,a=U(e.y1)?e.y1.field:void 0;return t&&n?"left-bottom":i&&n?"left-top":i&&a?"top-right":t&&a?"right-bottom":t&&i?"top-bottom":n&&a?"left-right":"unknown"}function me(e,t){t.forEach((function(t){var i=function(e){var t=new de(!0),i=[U(e.x)?e.x.field:void 0,U(e.x1)?e.x1.field:void 0,U(e.y)?e.y.field:void 0,U(e.y1)?e.y1.field:void 0].filter((function(e){return e}));return i.length<2?(t.setMsg("Less than two fields are specified for a `link-between` mark."),t.setIsValid(!1)):i.length>2&&t.setMsg("More than two fields are specified for a `link-between` mark."),t}(t.track);if(i.isValid())switch(function(e){var t=U(e.x)?e.x.field:void 0,i=U(e.xe)?e.xe.field:void 0,n=U(e.x1)?e.x1.field:void 0,a=U(e.x1e)?e.x1e.field:void 0,r=U(e.y)?e.y.field:void 0,o=U(e.ye)?e.ye.field:void 0,l=U(e.y1)?e.y1.field:void 0,s=U(e.y1e)?e.y1e.field:void 0,c={x:[t,i].filter((function(e){return e})).length,xe:[n,a].filter((function(e){return e})).length,y:[r,o].filter((function(e){return e})).length,ye:[l,s].filter((function(e){return e})).length};return"link-between"===e.mark?Object.keys(c).map((function(e){return c[e]})).filter((function(e){return e>=2})).length>=2?"band-connection":"line-connection":"unknown"}(t.track)){case"line-connection":L(t.track.data)&&y.b(t.track.data.url).then((function(i){return function(e,t,i){var n=new ge(t),a=U(t.x)?t.x.field:void 0,r=U(t.x1)?t.x1.field:void 0,o=U(t.y)?t.y.field:void 0,l=U(t.y1)?t.y1.field:void 0,c=[a,r,o,l].filter((function(e){return e})),d=Object(s.a)(c,2),u=d[0],h=d[1],g=y.g().domain([0,99]).range([i.x,i.x+i.width]),p=y.g().domain([0,99]).range([i.y,i.y+i.height]),m=[],f=pe(t);f.includes("left")&&m.push({x:function(){return i.x},y:function(e){return p(e[o])}}),f.includes("bottom")&&m.push({x:function(e){return g(e[a])},y:function(){return i.y+i.height}}),f.includes("top")&&m.push({x:function(e){return g(e[r])},y:function(){return i.y}}),f.includes("right")&&m.push({x:function(){return i.x+i.width},y:function(e){return p(e[l])}}),e.selectAll(".line").data(t.data).enter().filter((function(e){return Math.abs(e[u]-e[h])<30})).append("line").attr("x1",(function(e){return m[0].x(e)})).attr("y1",(function(e){return m[0].y(e)})).attr("x2",(function(e){return m[1].x(e)})).attr("y2",(function(e){return m[1].y(e)})).attr("fill",n.getStyle().fill).attr("stroke",n.getStyle().stroke).attr("stroke-width",n.getStyle().strokeWidth).attr("opacity",n.getStyle().opacity)}(e,Object(l.a)(Object(l.a)({},t.track),{},{data:i}),t.boundingBox)}));break;case"band-connection":L(t.track.data)&&y.b(t.track.data.url).then((function(i){return function(e,t,i){var n=new ge(t),a=U(t.x)?t.x.field:void 0,r=U(t.xe)?t.xe.field:void 0,o=U(t.x1)?t.x1.field:void 0,l=U(t.x1e)?t.x1e.field:void 0,s=U(t.y)?t.y.field:void 0,c=U(t.ye)?t.ye.field:void 0,d=U(t.y1)?t.y1.field:void 0,u=U(t.y1e)?t.y1e.field:void 0,h=y.g().domain([0,99]).range([i.x,i.x+i.width]),g=y.g().domain([0,99]).range([i.y,i.y+i.height]),p=[],m=pe(t);m.includes("left")&&p.push({x:function(){return i.x},xe:function(){return i.x},y:function(e){return g(e[s])},ye:function(e){return g(e[c])}}),m.includes("bottom")&&p.push({x:function(e){return h(e[a])},xe:function(e){return h(e[r])},y:function(){return i.y+i.height},ye:function(){return i.y+i.height}}),m.includes("top")&&p.push({x:function(e){return h(e[o])},xe:function(e){return h(e[l])},y:function(){return i.y},ye:function(){return i.y}}),m.includes("right")&&p.push({x:function(){return i.x+i.width},xe:function(){return i.x+i.width},y:function(e){return g(e[d])},ye:function(e){return g(e[u])}}),e.selectAll(".polygon").data(t.data).enter().append("polygon").attr("points",(function(e){var t="".concat(p[0].x(e),",").concat(p[0].y(e)),i="".concat(p[0].xe(e),",").concat(p[0].ye(e)),n="".concat(p[1].xe(e),",").concat(p[1].ye(e)),a="".concat(p[1].x(e),",").concat(p[1].y(e));return"".concat(t," ").concat(i," ").concat(n," ").concat(a)})).attr("fill",n.getStyle().fill).attr("stroke",n.getStyle().stroke).attr("stroke-width",n.getStyle().strokeWidth).attr("opacity",n.getStyle().opacity)}(e,Object(l.a)(Object(l.a)({},t.track),{},{data:i}),t.boundingBox)}))}else i.printValidity()}))}function fe(e,t,i,n){var a,r,o,l=null!==(a=null===(r=t.layout)||void 0===r?void 0:r.wrap)&&void 0!==a?a:999,s=[],c=n.x,d=n.y;"horizontal"===(null===(o=t.layout)||void 0===o?void 0:o.direction)?t.tracks.forEach((function(e,t){$(e)&&(s.push({track:e,boundingBox:{x:c,width:e.width,y:d,height:e.height}}),c+=e.width+3,t%l===l-1&&(c=n.x,d=d+=e.height+3))})):t.tracks.forEach((function(e,t){$(e)&&(s.push({track:e,boundingBox:{x:c,width:e.width,y:d,height:e.height}}),d+=e.height+3,t%l===l-1&&(c=c+=e.width+3,d=n.y))})),e.selectAll("rect").data(s).enter().append("rect").attr("x",(function(e){return e.boundingBox.x})).attr("width",(function(e){return e.boundingBox.width})).attr("y",(function(e){return e.boundingBox.y})).attr("height",(function(e){return e.boundingBox.height})).attr("fill",(function(e){return ye.background(e.track)})).attr("stroke",(function(e){return ye.stroke(e.track)})).attr("stroke-width",(function(e){return ye.strokeWidth(e.track)})),me(e,s.filter((function(e){return"link-between"===e.track.mark}))),function(e,t,i){var n=[];t.forEach((function(e){var t=e.track,i=e.boundingBox;n.push({boundingBox:i,viewConfig:ce(t,i)})})),i(n)}(0,s.filter((function(e){return q(e.track)})),i)}var ye={background:function(e){var t,i;return null!==(t=null===(i=e.style)||void 0===i?void 0:i.background)&&void 0!==t?t:"white"},stroke:function(e){var t,i;return null!==(t=null===(i=e.style)||void 0===i?void 0:i.stroke)&&void 0!==t?t:"#e0e0e0"},strokeWidth:function(e){var t,i;return null!==(t=null===(i=e.style)||void 0===i?void 0:i.strokeWidth)&&void 0!==t?t:1}};function ve(e,t,i,n){var a;e.selectAll("*").remove(),"circular"===(null===(a=t.layout)||void 0===a?void 0:a.type)?function(e,t,i,n){var a,r,o,l,s=null!==(a=null===(r=t.layout)||void 0===r?void 0:r.wrap)&&void 0!==a?a:999,c=n.height/2,d=y.n("horizontal"===(null===(o=t.layout)||void 0===o?void 0:o.direction)?t.tracks.filter((function(e,t){return t<s})).map((function(e){return $(e)?e.width:0})):t.tracks.filter((function(e,t){return t%s==0})).map((function(e){return $(e)?e.width:0}))),u=2*Math.PI/160,h=[],g=0,p=0;"horizontal"===(null===(l=t.layout)||void 0===l?void 0:l.direction)?t.tracks.forEach((function(e,t){if($(e)){var i=e.height,n=e.width,a=2*Math.PI*p/d+u,r=a+2*Math.PI*n/d-u;h.push({track:e,arc:{innerRadius:c-g-i,outerRadius:c-g,startAngle:a,endAngle:r}}),p+=n,t%s===s-1&&(p=0,g+=i+3)}})):t.tracks.forEach((function(e,t){if($(e)){var i=e.height,n=e.width,a=2*Math.PI*p/d+u,r=a+2*Math.PI*n/d-u;h.push({track:e,arc:{innerRadius:c-g-i,outerRadius:c-g,startAngle:a,endAngle:r}}),g+=i+3,t%s===s-1&&(g=0,p+=n)}})),console.log("arcs",h),e.append("g").attr("transform","translate(".concat(n.x+c,", ").concat(n.y+c,")")).selectAll("path").data(h).enter().append("path").attr("fill",(function(e){return ye.background(e.track)})).attr("stroke",(function(e){return ye.stroke(e.track)})).attr("stroke-width",(function(e){return ye.strokeWidth(e.track)})).attr("d",(function(e){return y.a().innerRadius(e.arc.innerRadius).outerRadius(e.arc.outerRadius)(e.arc)}))}(e,t,0,n):fe(e,t,i,n)}function be(e){var t,i,n,a,r={width:0,height:0},o=null!==(t=null===(i=e.layout)||void 0===i?void 0:i.wrap)&&void 0!==t?t:999;return"circular"===(null===(n=e.layout)||void 0===n?void 0:n.type)?(r.height=300,r.height+=y.n(e.tracks.filter((function(e,t){return t%o===0})).map((function(e){return $(e)?e.height:0}))),r.width=r.height):"horizontal"===(null===(a=e.layout)||void 0===a?void 0:a.direction)?(r.width=y.n(e.tracks.filter((function(e,t){return t<o})).map((function(e){return $(e)?e.width:0}))),r.height=y.n(e.tracks.filter((function(e,t){return t%o===0})).map((function(e){return $(e)?e.height:0}))),r.width+=3*y.f([o-1,e.tracks.length-1]),r.height+=3*Math.floor(e.tracks.length/o)):(r.width=y.n(e.tracks.filter((function(e,t){return t%o===0})).map((function(e){return $(e)?e.width:0}))),r.height=y.n(e.tracks.filter((function(e,t){return t<o})).map((function(e){return $(e)?e.height:0}))),r.width+=3*Math.floor(e.tracks.length/o),r.height+=3*y.f([o-1,e.tracks.length-1])),r}i(757);Object(S.a)({name:"GeminiTrack",track:j,config:j.config});var ke=Z.length-2;var xe=function(){var e=Object(n.useRef)(null),t=Object(n.useRef)(null),i=Object(n.useState)([]),r=Object(s.a)(i,2),o=r[0],c=r[1],d=Object(n.useState)(Z[ke]),u=Object(s.a)(d,2),h=u[0],g=u[1],p=Object(n.useState)("Full Glyph Definition"),m=Object(s.a)(p,2),f=m[0],v=m[1],b=Object(n.useState)(D()(Z[ke].spec)),k=Object(s.a)(b,2),x=k[0],w=k[1],O=Object(n.useState)(Z[ke].glyphWidth),_=Object(s.a)(O,2),j=_[0],S=_[1],z=Object(n.useState)(Z[ke].glyphHeight),C=Object(s.a)(z,2),P=C[0],M=C[1];Object(n.useEffect)((function(){w("Full Glyph Definition"===f?D()(H(JSON.parse(D()(h.spec)))):D()(h.spec)),S(h.glyphWidth),M(h.glyphHeight),c([])}),[h,f]),Object(n.useEffect)((function(){var i,n,a;try{a=H(JSON.parse(x))}catch(o){console.warn("Cannnot parse the edited code.")}if(a){!function(e,t,i,n){if(e&&t){y.l(e).selectAll("*").remove();var a=i.x,r=i.y;te(e,i.width+2*a,i.height+2*r,a,r,!1),ve(y.l(e).append("g").attr("width",i.width).attr("height",i.height),t,n,i)}}(t.current,a,{x:60,y:60,width:be(a).width,height:be(a).height},(function(e){c(e)})),y.l(e.current).selectAll("*").remove();var r=null===(i=a)||void 0===i||null===(n=i.tracks)||void 0===n?void 0:n.find((function(e){return!(!$(e)||!N(e.mark))&&"compositeMark"===e.mark.type}));r&&$(r)&&L(r.data)&&y.b(r.data.url).then((function(t){return ie(e.current,Object(l.a)(Object(l.a)({},r),{},{data:t}),j,P)}))}}),[x,j,P]);var B=Object(n.useMemo)((function(){return o.map((function(e){return a.a.createElement("div",{key:D()(e.viewConfig),style:{position:"absolute",display:"block",left:e.boundingBox.x,top:e.boundingBox.y,width:e.boundingBox.width,height:e.boundingBox.height}},a.a.createElement(E.HiGlassComponent,{options:{bounded:!0,containerPaddingX:0,containerPaddingY:0,viewMarginTop:0,viewMarginBottom:0,viewMarginLeft:0,viewMarginRight:0,viewPaddingTop:0,viewPaddingBottom:0,viewPaddingLeft:0,viewPaddingRight:0,sizeMode:"bounded"},viewConfig:e.viewConfig}))}))}),[o]);return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"demo-navbar"},"\ud83e\uddec Gemini ",a.a.createElement("code",null,"Editor"),a.a.createElement("select",{onChange:function(e){g(Z.find((function(t){return t.name===e.target.value})))},defaultValue:h.name},Z.map((function(e){return a.a.createElement("option",{key:e.name,value:e.name},e.name)}))),a.a.createElement("select",{onChange:function(e){v(e.target.value)},defaultValue:"Full Glyph Definition"},["Full Glyph Definition","Predefined Glyph"].map((function(e){return a.a.createElement("option",{key:e,value:e},e)})))),a.a.createElement("div",{className:"editor"},a.a.createElement(A.a,{className:"split-pane-root",split:"vertical",defaultSize:"35%",onChange:function(){}},a.a.createElement(A.a,{split:"horizontal",defaultSize:"50%",onChange:function(){}},a.a.createElement(T,{code:x,readOnly:!1,onChange:Object(J.debounce)((function(e){w(e)}),1e3)}),a.a.createElement(A.a,{split:"vertical",defaultSize:"100%",onChange:function(){}},a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"editor-header"},a.a.createElement("b",null,"Compiled HiGlass ViewConfigs")),a.a.createElement(T,{code:D()(o.map((function(e){return e.viewConfig}))),readOnly:!0,onChange:function(){}})),a.a.createElement(a.a.Fragment,null))),a.a.createElement(A.a,{split:"horizontal",defaultSize:"0%",onChange:function(){}},a.a.createElement("div",{className:"preview-container",hidden:!0},a.a.createElement("b",null,"Composite Mark Preview"),a.a.createElement("div",null,a.a.createElement("svg",{ref:e}))),a.a.createElement("div",{className:"preview-container"},a.a.createElement("b",null,"Layout Preview"),a.a.createElement("div",{style:{position:"relative"}},a.a.createElement("svg",{ref:t}),B))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(xe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[472,1,2]]]);
//# sourceMappingURL=main.1275520c.chunk.js.map